<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>CF-355: Начало</title>
    <style>
    #particleCanvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
      width: 100%;
      height: 100%;
    }
    
    #loading-screen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: #000;
      color: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 10000;
      font-family: 'Courier New', monospace;
    }
    #loading-ring {
      text-align: center;
    }
    #loading-ring svg {
      width: 120px;
      height: 120px;
      margin-bottom: 1rem;
    }
    #loading-text {
      font-size: 1rem;
      letter-spacing: 0.1em;
      margin-bottom: 0.5rem;
    }
    #loading-percent {
      font-size: 1.2rem;
      font-weight: bold;
    }
    
    .interactive-thought {
      color: #ffe066;
      letter-spacing: 0.12em;
      text-shadow:
        0 0 2px #ffe066,
        0 0 6px #ffe06688,
        1px 0 0 #222,
        0 1px 0 #222;
      filter: contrast(1.3) brightness(1.1);
      animation: crtFlicker 0.18s infinite;
    }

    @keyframes crtFlicker {
      0% { opacity: 0.95; }
      50% { opacity: 0.85; }
      100% { opacity: 0.95; }
}

    body, button, a, input, textarea, select {
      cursor: none !important;
    }

    body {
      cursor: none;
    }

    #customCursor {
      position: fixed;
      top: 0;
      left: 0;
      width: 12px;
      height: 12px;
      background-color: white;
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      transform: translate(-50%, -50%);
      transition: transform 0.1s ease, width 0.2s ease, height 0.2s ease;
    }

    .pointer-hover #customCursor {
      width: 24px;
      height: 24px;
      background-color: white;
      opacity: 0.9;
    }

    body {
      margin: 0;
      background-color: #000;
      color: #ccc;
      font-family: 'Courier New', monospace;
      overflow: hidden;
    }
    #container {
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      position: relative;
    }
    #startBtn {
      padding: 1rem 2rem;
      background-color: #111;
      color: #ccc;
      border: 2px solid #ccc;
      cursor: pointer;
      font-size: 1.2rem;
    }
    .slide {
      position: absolute;
      top: 100vh;
      opacity: 0;
      transition: all 0.8s ease-in-out;
      max-width: 600px;
      padding: 20px;
      text-align: center;
      text-shadow: 0 0 1px #888, 0 0 1px #aaa, 0 0 2px #ccc;
    }
    .slide.active {
      top: 50%;
      transform: translateY(-50%);
      opacity: 1;
    }
    .slide.out {
     top: -50%;
     transform: translateY(50%);
     opacity: 1;
    }
    .yellow-annot {
      color: #ffe066;
      font-weight: bold;
      border-bottom: 1px dashed #ffe066;
      position: relative;
      transition: color 0.2s;
    }
    .yellow-annot:hover {
      color: #fffbe0;
    }
    .yellow-annot-tooltip {
      display: block;
      visibility: hidden;
      opacity: 0;
      position: absolute;
      left: 50%;
      top: 2.2em;
      transform: translateX(-50%);
      background: rgba(30, 34, 40, 0.98);
      color: #ffe066;
      border-radius: 0;
      border: 1.5px solid #ffe066;
      box-shadow: 0 6px 24px 0 #000a, 0 1.5px 6px 0 #ffe06655;
      padding: 10px 18px;
      font-size: 1em;
      z-index: 2000;
      white-space: pre-line;
      min-width: 320px;
      max-width: 600px;
      pointer-events: auto;
      transition: opacity 0.18s cubic-bezier(.4,2,.6,1), visibility 0.18s cubic-bezier(.4,2,.6,1);
      font-family: 'JetBrains Mono', 'Fira Mono', 'Consolas', 'Courier New', monospace;
      font-weight: 500;
      letter-spacing: 0.02em;
      line-height: 1.5;
      text-align: left;
    }
    .yellow-annot:hover .yellow-annot-tooltip,
    .yellow-annot-tooltip:hover {
      visibility: visible;
      opacity: 1;
    }
    .yellow-animated {
      color: #ffe066;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      font-size: 1.1em;
      letter-spacing: 1px;
      margin-top: 0;
      margin-bottom: 0.5em;
      white-space: pre;
      transition: color 0.3s;
      position: fixed;
      top: 1.5em;
      left: 2em;
      text-align: left;
      z-index: 1000;
      pointer-events: none;
    }

    html, body, #container, .slide, .yellow-annot, .yellow-annot-tooltip, .yellow-animated {
      user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
      -moz-user-select: none;
    }
  </style>
</head>
<div id="loading-screen">
  <div id="loading-ring">
    <svg viewBox="0 0 100 100">
      <circle cx="50" cy="50" r="45" stroke="#ffe06633" stroke-width="6" fill="none" />
      <circle id="loading-progress" cx="50" cy="50" r="45" stroke="#ffffff" stroke-width="6"
              stroke-dasharray="283" stroke-dashoffset="283" fill="none"
              stroke-linecap="round" />
    </svg>
    <div id="loading-text">Человек воспитывается для свободы</div>
    <div id="loading-percent">0%</div>
  </div>
<script>
window.addEventListener('load', async () => {
  const loadingScreen = document.getElementById('loading-screen');
  const loadingProgress = document.getElementById('loading-progress');
  const loadingPercent = document.getElementById('loading-percent');

  const audioElements = Array.from(document.querySelectorAll('audio'));
  const total = audioElements.length;
  let loaded = 0;

  const updateProgress = () => {
    const percent = Math.floor((loaded / total) * 100);
    loadingPercent.textContent = percent + '%';
    const offset = 283 - (283 * percent / 100);
    loadingProgress.style.strokeDashoffset = offset;
  };

  async function fullyPreloadAudio(audio) {
    return new Promise(resolve => {
      let finished = false;
      const onReady = () => {
        if (finished) return;
        finished = true;
        loaded++;
        updateProgress();
        resolve();
      };
      const onError = () => {
        if (finished) return;
        console.warn(`Ошибка загрузки аудио: ${audio.src}`);
        finished = true;
        loaded++;
        updateProgress();
        resolve();
      };

      audio.addEventListener('canplaythrough', onReady, { once: true });
      audio.addEventListener('error', onError, { once: true });

      try {
        audio.load();
      } catch {
        onError();
      }
    });
  }

  updateProgress();

  await Promise.all(audioElements.map(a => fullyPreloadAudio(a)));

  loadingPercent.textContent = '100%';
  const offset = 283 - (283 * 100 / 100);
  loadingProgress.style.strokeDashoffset = offset;

  await new Promise(res => setTimeout(res, 400));

  loadingScreen.style.transition = 'opacity 1s ease';
  loadingScreen.style.opacity = 0;
  setTimeout(() => loadingScreen.remove(), 1000);
});

</script>
</div>
<div id="customCursor"></div>
<body>
  <canvas id="particleCanvas"></canvas>

  <div id="container">
    <button id="startBtn">начать</button>
  </div>
  <span id="yellowAnimatedGlobal" class="yellow-animated" style="display:none"></span>

  <audio id="marsTrack" src="sound/kventa/Mars_Special_Track.mp3"></audio>


  <audio id="ambience1" src="sound/kventa/212025__qubodup__sci-fi-laboratory-ambience.ogg" loop></audio>
  <audio id="music1" src="sound/kventa/The_Prison.mp3" loop></audio>
  <audio id="ambience3" src="sounds/ambience3.mp3" loop></audio>

  <audio id="open1" src="sound/kventa/425090__neospica__pressurized-door-opening.wav"></audio>
  <audio id="open2" src="sound/kventa/90143__pengo_au__steam_burst.wav"></audio>
  <audio id="open3" src="sound/kventa/325269__deleted_user_2104797__body-fall-2.wav"></audio>
  <audio id="open4" src="sound/kventa/195955__minian89__bucket_splash.mp3"></audio>

  <audio id="surgery" src="sound/kventa/520222__podcapocalipsis__broken-bone-and-flesh.wav"></audio>

  <audio id="access" src="sound/kventa/459992__florianreichelt__beep-short.mp3"></audio>

  <audio id="writing" src="sound/kventa/33773__digifishmusic__writing.wav"></audio>

  <audio id="click" src="sound/kventa/mixkit-old-camera-shutter-click-1137.wav"></audio>

  <audio id="CF377" src="sound/kventa/CF-377 coming.wav"></audio>

  <audio id="sighwithfx" src="sound/kventa/sighwithfx.wav"></audio>

  <audio id="alarm1" src="sound/kventa/Alarm1.wav"></audio>

  <audio id="radiodeath" src="sound/kventa/radiodeath.wav"></audio>

  <audio id="part3" src="sound/kventa/part3.mp3" loop></audio>

  <audio id="insolitum" src="sound/kventa/insolitum.mp3" loop></audio>

  <audio id="radiotelkhin" src="sound/kventa/Radiotelkhin.wav" loop></audio>

  <audio id="final" src="sound/kventa/Final.mp3"></audio>

  <audio id="big_alarm" src="sound/kventa/Big_alarm.wav"></audio>

  <audio id="door_opening" src="sound/kventa/Door_opening.wav"></audio>

  <audio id="take_off" src="sound/kventa/Take_off.wav"></audio>

  <audio id="launching" src="sound/kventa/launching.wav"></audio>

  <audio id="fail" src="sound/kventa/fail.wav"></audio>


  <script>

    let analyser, dataArray, marsTrackNode;
    let isMarsEQ = false;
    let marsCode = ['m', 'a', 'r', 's'];
    let marsIndex = 0;

    document.addEventListener('keydown', async (e) => {
      if (e.key.toLowerCase() === marsCode[marsIndex]) {
        marsIndex++;
        if (marsIndex === marsCode.length) {
          marsIndex = 0;
          await startMarsSequence();
        }
      } else {
        marsIndex = 0;
      }
    });

    

async function startMarsSequence() {
  drawLinks = drawLinksMars;
  readyForClick = false;
  startBtn.style.display = 'none';

  const marsAudio = document.getElementById('marsTrack');
  await audioCtx.resume();
  marsAudio.volume = 0.6;

  marsTrackNode = audioCtx.createMediaElementSource(marsAudio);
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 64;
  dataArray = new Uint8Array(analyser.frequencyBinCount);

  marsTrackNode.connect(analyser);
  analyser.connect(audioCtx.destination);

  marsAudio.play().catch(err => console.warn("Autoplay blocked:", err));
  isMarsEQ = true;

  const marsSlideTimings = [
    { text: '...', time: 0 },
    { text: 'На Марсе классно', time: 44 },
    { text: 'Красные пески, крутые горы и краторы', time: 45 },
    { text: 'Безумно красивые каналы рядом с экватором', time: 47 },
    { text: 'Ничто не сравнится с тамошними закатами', time: 50 },
    { text: 'Правда холодновато...', time: 52 },
    { text: 'За то две луны на небе...', time: 55 },
    { text: 'Жаль, что так поздно...', time: 57 },
    { text: 'Здесь было еще прикольнее...', time: 63 },
    { text: 'Летом цвели...', time: 65 },
    { text: 'Невиданно высокии...', time: 68 },
    { text: 'Шумели гигантскими кронами...', time: 71 },
    { text: 'Где в их тени прятались...', time: 73 },
    { text: 'Они были похожи на нас', time: 76 },
    { text: 'В целом без оголтелой экзотики', time: 79 },
  ];

  const marsSlides = marsSlideTimings.map(s => createSlide({ text: s.text, play: ['click'] }));
  marsSlides.forEach(el => slidesElements.push(el));

  let marsSlideIndex = -1;

  function checkMarsSlides() {
    const current = marsAudio.currentTime;
    if (marsSlideIndex < marsSlides.length - 1 &&
        current >= marsSlideTimings[marsSlideIndex + 1].time) {

      if (marsSlideIndex >= 0) {
        marsSlides[marsSlideIndex].classList.remove('active');
        marsSlides[marsSlideIndex].classList.add('out');
      }

      marsSlideIndex++;
      marsSlides[marsSlideIndex].classList.add('active');
      resetParticleHomes();
    }
    requestAnimationFrame(checkMarsSlides);
  }

  requestAnimationFrame(checkMarsSlides);
}



    
    const container = document.getElementById('container');
    const startBtn = document.getElementById('startBtn');

    const audioMap = {
      ambience1: document.getElementById('ambience1'),
      music1: document.getElementById('music1'),
      ambience2: document.getElementById('ambience2'),

      open1: document.getElementById('open1'),
      open2: document.getElementById('open2'),
      open3: document.getElementById('open3'),
      open4: document.getElementById('open4'),

      surgery: document.getElementById('surgery'),

      access: document.getElementById('access'),

      writing: document.getElementById('writing'),

      click: document.getElementById('click'),

      marsTrack: document.getElementById('marsTrack'),

      CF377: document.getElementById('CF377'),

      sighwithfx: document.getElementById('sighwithfx'),

      alarm1: document.getElementById('alarm1'),

      radiodeath: document.getElementById('radiodeath'),

      part3: document.getElementById('part3'),

      insolitum: document.getElementById('insolitum'),

      radiotelkhin: document.getElementById('radiotelkhin'),

      final: document.getElementById('final'),

      big_alarm: document.getElementById('big_alarm'),

      door_opening: document.getElementById('door_opening'),

      take_off: document.getElementById('take_off'),

      launching: document.getElementById('launching'),

      fail: document.getElementById('fail'),
      
    };

  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function createFilteredSource(audioElement, type = 'lowpass', freq = 500) {
  const source = audioCtx.createMediaElementSource(audioElement);
  const filter = audioCtx.createBiquadFilter();
  filter.type = type;
  filter.frequency.value = freq;
  source.connect(filter).connect(audioCtx.destination);
  return filter;
}

const filters = {
ambience1: createFilteredSource(audioMap.ambience1),
final: createFilteredSource(audioMap.final)
};
    const slides = [

      {
        text: '...',
        play: ['ambience1', 'music1', 'click'],
        stop: [],
        thoughts: [
  
],
        filterOn: ['ambience1']
      },
      {
        text: '...',
        play: ['ambience1', 'music1', 'click'],
        stop: [],
        thoughts: [
  { text: "Моя первая мысль", minLinks: 1, removeBelow: 1 },
  { text: "Где я?", minLinks: 6, removeBelow: 4 },
  { text: "Ощущения приятные", minLinks: 6, removeBelow: 4 },
  { text: "Я плаваю?", minLinks: 4, removeBelow: 2 }
],
        filterOn: ['ambience1'],
      },
      {
        text: 'Тепло...',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  
]},
      {
        text: 'Я чувствую, как что-то теплое обволакивает меня с ног до головы.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Нос чешется", minLinks: 4, removeBelow: 2 },
  { text: "Тепло, приятно...", minLinks: 6, removeBelow: 4 },
  { text: "Вот бы это продолжалось вечно", minLinks: 6, removeBelow: 4 },
  { text: "Что это там пикает?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '...',
        play: ['open1', 'open2', 'open3', 'open4', 'click'],
        stop: [],
        filterOff: ['ambience1'],
        thoughts:[
  { text: "Не-е-ет...", minLinks: 4, removeBelow: 2 },
  { text: "Я хочу обратно", minLinks: 6, removeBelow: 4 },
  { text: "Неприятно, холодно", minLinks: 6, removeBelow: 4 },
  { text: "Пахнет какой-то химией", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Холодно...',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  
]},
      {
        text: '<em>Сквозь глухую темноту слышно:</em><br><br><span style="color: #ffe066;">"Сорок семь здоровы... Троих на утилизацию..."</span>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Что..?", minLinks: 4, removeBelow: 4 },
  { text: "Утилизация?", minLinks: 2, removeBelow: 1 },
  { text: "Надеюсь, меня не утилизируют...", minLinks: 1, removeBelow: 1 }
]},
      {
        text: 'Что это за голос? Кого на утилизацию?',
        play: ['click'],
        stop: []
      },
      {
        text: '"Здоровых отправьте на имплантацию и разделите на группы."',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Может речь... про кроликов?", minLinks: 2, removeBelow: 1 }
]},
      {
        text: 'Я чувствую отдалённые прикосновения, затем ощущения затихают...',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Не дают поспать...", minLinks: 4, removeBelow: 2 },
  { text: "Неприятно...", minLinks: 3, removeBelow: 1 }
]},
      {
        text: '...',
        play: ['surgery', 'click'],
        stop: []
      },
      {
        text: '...',
        yellowAnimated: [
          {
            text: "connecting the neural interface",
            dots: true,
            final: "---[neural interface connected]---",
            play: [], 
            endPlay: ["access"] 
          },
          {
            text: "cognitive support activation",
            dots: true,
            final: "---[cognitive support is live]---",
            play: [],
            endPlay: ["access"]
          }
        ],
        play: ['click'],
        stop: []
      },
      {
        text: '...',
        play: ['click'],
        stop: []
      },
      {
        text: 'Сколько времени прошло?',
        play: ['click'],
        stop: ['ambience1']
      ,
  thoughts: [
  { text: "Просыпаться совсем не хочется...", minLinks: 4, removeBelow: 3 },
  { text: "Что-то в голове", minLinks: 3, removeBelow: 2 },
  { text: "Щелкает", minLinks: 2, removeBelow: 1 }
]},
      {
        text: '<em>Яркий свет. Ослепительный свет. ...Фонарик?</em>"',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Грубо", minLinks: 2, removeBelow: 1 },
  { text: "Больно глазам...", minLinks: 4, removeBelow: 3 },
  { text: "К чему мне в глаза светить?!", minLinks: 3, removeBelow: 2 }
]},
      {
        text: '<em>Я проморгалась и прищурилась, смотря перед собой</em><br><br>Передо мной стоит мужчина в белом халате. Он убрал фонарик в карман и записал что-то в планшет.',
        play: ['writing', 'click'],
        stop: []
      ,
  thoughts: [
  { text: "О нет... это госпиталь?", minLinks: 2, removeBelow: 1 },
  { text: "Как я сюда попала?", minLinks: 3, removeBelow: 2 },
  { text: "Не люблю докторов...", minLinks: 4, removeBelow: 3 }
]},
      {
        text: '"Она в сознании..."<br><br>Мужчина отдал планшет девушке и вышел из комнаты',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Будить было совсем не обязательно", minLinks: 3, removeBelow: 2 },
  { text: "И на что я им?", minLinks: 2, removeBelow: 1 }
]},
      {
        text: 'Девушка смотрит в планшет, затем кладет его на стол и садится на стул напротив меня и слегка улыбается.<br><br><color:alice>"С пробуждением. Понимаешь меня? Говорить умеешь?"</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Добрая", minLinks: 2, removeBelow: 1 },
  { text: "А умею ли я говорить..?", minLinks: 3, removeBelow: 2 },
  { text: "Что за вопросы такие?", minLinks: 4, removeBelow: 3 }
]},
      {
        text: 'Почему все ощущается так странно..? <br><em>Я смотрю на девушку передо мной.</em> Она одета в синюю униформу. у нее аккуратно постриженные черные волосы на уровне плеч. Она мягко улыбается мне. Я чувствую себя комфортно рядом с ней. Нужно ей ответить...<br><br><color:cf>"Да... Кажется умею..."</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Надеюсь, я умею говорить...", minLinks: 4, removeBelow: 3 },
  { text: "А что если я не могу говорить?", minLinks: 1, removeBelow: 1 },
  { text: "Вдруг я немая?", minLinks: 3, removeBelow: 1 },
  { text: "Может поэтому я в госпитале?", minLinks: 2, removeBelow: 1 }
]},
      {
        text: 'Девушка подняла два больших пальца вверх и кивнула.<br><br><color:alice>"Меня зовут Алиса. Я помогу тебе освоиться."</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Алиса?", minLinks: 8, removeBelow: 8 },
  { text: "Алиса...", minLinks: 7, removeBelow: 6 },
  { text: "Алиса.", minLinks: 6, removeBelow: 5 },
  { text: "Алиса..", minLinks: 5, removeBelow: 4 },
  { text: "Алиса ", minLinks: 4, removeBelow: 3 },
  { text: "Алиса  ", minLinks: 3, removeBelow: 2 },
  { text: "Алиса   ", minLinks: 2, removeBelow: 1 },
  { text: "Алиса       ", minLinks: 1, removeBelow: 1 }
]},
      {
        text: 'Она сложила руки<br><br><color:alice>"Для начала. Ты репликант. Искусственно созданный человек. Прямо сейчас мы находимся в системе [[Никс|Твое место дислокации. Важнейшая система в пределах пространства ОЧС на данный момент.]]. Твой номер - CF-355"</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Си-Эф?", minLinks: 2, removeBelow: 1 },
  { text: "Почему у меня номер?!", minLinks: 1, removeBelow: 1 },
  { text: "У нее имя, а у меня номер...", minLinks: 3, removeBelow: 2 },
  { text: "Это не правильно...", minLinks: 4, removeBelow: 3 }
]},
      {
        text: 'Стоп. Это кажется знакомым.<br><br> <color:cf>"Кажется... Я откуда-то уже знаю про систему Никс."</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Центр корпоративной войны", minLinks: 5, removeBelow: 4 },
  { text: "Исход", minLinks: 2, removeBelow: 1 },
  { text: "Эребус", minLinks: 3, removeBelow: 2 },
  { text: "Форон", minLinks: 4, removeBelow: 3 },
  { text: "Брикбёрн", minLinks: 5, removeBelow: 4 },
  { text: "Калдарк", minLinks: 5, removeBelow: 4 },
  { text: "Роанок", minLinks: 5, removeBelow: 4 },
  { text: "Йуклит", minLinks: 5, removeBelow: 4 },
  { text: "Где я..?", minLinks: 3, removeBelow: 2 }
]},
      {
        text: 'Алиса постучала пальцем по своей голове. <br><br><color:alice>"Имплант. Он подсказывает тебе. Он позволит тебе быстрее обучаться, а также поможет справляться с эмоциями."</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Что-то мешает моим мыслям...", minLinks: 1, removeBelow: 1 },
  { text: "Я чувствую...", minLinks: 2, removeBelow: 1 },
  { text: "Странно...", minLinks: 3, removeBelow: 2 },
  { text: "Спокойно", minLinks: 3, removeBelow: 2 },
  { text: "Ничего не чувствую...", minLinks: 4, removeBelow: 2 }
]},
      {
        text: 'Она посмотрела на меня с некоторым сожалением... Но почему?<br>Она вернула свое прежнее выражение лица и продолжила:<br><br><color:alice>"Ты сейчас находишься на борту корабля [[Телхин|Флагман ОЧС. Оснащен тяжелой артиллерией. Также корабль выступает в качестве ремонтной станции, а также собирает легкие корабли, готовые к бою.]]"</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Со мной что-то не так", minLinks: 1, removeBelow: 1 },
  { text: "Я и есть кролик", minLinks: 3, removeBelow: 2 },
  { text: "Что я тут вообще делаю...", minLinks: 3, removeBelow: 2 },
  { text: "Кто я такая?", minLinks: 4, removeBelow: 3 }
]},
      {
        text: '<color:alice>"Прямо сейчас Телхин участвует в бою. Мы находимся в тылу и подготавливаем таких как ты для управления штурмовиками. Через неделю ты вылетаешь в бой."</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Нет...", minLinks: 2, removeBelow: 2 },
  { text: "Зачем мне это вообще", minLinks: 3, removeBelow: 2 },
  { text: "Все ясно", minLinks: 4, removeBelow: 3 },
  { text: "Должна лететь в бой", minLinks: 1, removeBelow: 1 },
  { text: "Вот зачем я им нужна...", minLinks: 3, removeBelow: 3 },
  { text: "Совсем не страшно... почему?", minLinks: 2, removeBelow: 1 },
  { text: "Не хочу думать об этом", minLinks: 1, removeBelow: 1 }
]},
      {
        text: 'Вот оно как...<br>Алиса смотрит на меня, пытаясь понять мою реакцию. Замечая, что я спокойна, она кивает и продолжает<br><br><color:alice>"Твоё обучение скоро начнётся. Через час тебе нужно подойти в класс 45, а пока можешь сходить поесть."</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Ну пожили и хватит", minLinks: 4, removeBelow: 3 },
  { text: "Кушать хочется", minLinks: 2, removeBelow: 1 },
  { text: "Надеюсь, в столовой дают...", minLinks: 3, removeBelow: 2 },
  { text: "В голову ни одного блюда не приходит", minLinks: 1, removeBelow: 1 }
]},
      {
        text: '<color:alice>"Сейчас мы находимся в отдельной зоне, где происходит создание и обучение репликантов. Ну и жить пока ты будешь тоже тут. У тебя есть доступ в общую зону для персонала, так что тебе не обязательно сидеть в нашей зоне постоянно."</color>',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Пока поживу еще", minLinks: 3, removeBelow: 2 },
  { text: "Репликант... хоть не кролик", minLinks: 4, removeBelow: 2 },
  { text: "Лучше быть кроликом или репликантом?", minLinks: 4, removeBelow: 2 },
  { text: "Хуже чем кроликом-репликантом быть", minLinks: 4, removeBelow: 2 },
  { text: "Я знаю что такое репликант, но кто я..?", minLinks: 4, removeBelow: 2 }
]},
      {
        text: '<em>Некоторое время спустя я вышла в коридор общей зоны</em><br>Идя по коридору я видела людей. Многие спешили куда-то. Кажется офицер шел по коридору впереди. Рядом находящиеся члены экипажа отдавали ему честь. В этом жесте не было энтузиазма. Лишь заученное до рефлекса механическое движение. Сам офицер никак не реагировал и просто шел дальше.',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Какие все занятые", minLinks: 2, removeBelow: 1 },
  { text: "А я чем заниматься должна?", minLinks: 2, removeBelow: 1 },
  { text: "Я кушать иду", minLinks: 4, removeBelow: 2 },
  { text: "А мне нужно офицера приветствовать?", minLinks: 3, removeBelow: 2 }
]},
      {
        text: 'Все вокруг выглядят такими подавленными. Я не знаю стоит ли мне заводить разговор с кем-то...',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Может не думать лишний раз и хорошо?", minLinks: 3, removeBelow: 2 },
  { text: "Как-то... никак вообще", minLinks: 2, removeBelow: 1 },
  { text: "Зато не переживаю", minLinks: 3, removeBelow: 2 }
]},
      {
        text: 'Проходя очередной шлюз, я обнаружила по правую сторону коридора окно, выходящее на широкий ангар.',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Просторно!", minLinks: 1, removeBelow: 1 },
  { text: "Техника всякая", minLinks: 3, removeBelow: 2 },
  { text: "Штуки всякие...", minLinks: 4, removeBelow: 2 },
  { text: "Штурмовик!", minLinks: 2, removeBelow: 1 },
  { text: "Какие все занятые...", minLinks: 4, removeBelow: 3 }
]},
      {
        text: 'В ангаре кипела работа. Десятки человек занимались тем, что принимали в ангаре разбитые корабли. Из них доставали тела погибших и раненых. Тут же происходил и ремонт кораблей, если они еще подлежали восстановлению.',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Все это выглядит...", minLinks: 3, removeBelow: 2 },
  { text: "Это... плохо?", minLinks: 4, removeBelow: 3 },
  { text: "Скоро я займу их место...", minLinks: 2, removeBelow: 1 },
  { text: "И потом кто-то займет мое место...", minLinks: 2, removeBelow: 1 }
]},
      {
        text: 'Я засмотрелась на это, продолжая идти по коридору и вдруг в кого-то врезалась.',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Надо бы извиниться", minLinks: 2, removeBelow: 3 },
  { text: "А может ему стоит извиниться?", minLinks: 3, removeBelow: 2 },
  { text: "Хотят тут такие важные...", minLinks: 4, removeBelow: 3 }
]},
      {
        text: 'Я повернула голову и увидела перед собой инженера, который уронил на пол инструменты после столкновения со мной. Он посмотрел на меня со злобой и презрением.',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Ой...", minLinks: 1, removeBelow: 1 },
  { text: "Надо сказать что-то и срочно!", minLinks: 2, removeBelow: 1 },
  { text: "Прости?", minLinks: 4, removeBelow: 3 },
  { text: "Извиняюсь?", minLinks: 4, removeBelow: 3 },
  { text: "Извините?", minLinks: 4, removeBelow: 3 },
  { text: "Прошу прошения?", minLinks: 4, removeBelow: 3 }
]},
      {
        text: '<color:cf>"Ой, извините, я..."</color><br>Не успела я договорить, как он резко пнул меня под коленом. Удар лицом о стальной пол, тошнотворные ощущения от разбитого носа.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Больно!", minLinks: 4, removeBelow: 2 },
  { text: "За что?", minLinks: 6, removeBelow: 4 },
  { text: "Кровь пошла", minLinks: 6, removeBelow: 4 },
  { text: "ой-ой-ой...", minLinks: 4, removeBelow: 2 }
]
        
      },
      {
        text: '"Да пошла ты нахуй, сука!"<br>Затем стальной нос его ботинка врезался в мой бок. Какая ужасная боль...',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Я не могу ему ответить...", minLinks: 1, removeBelow: 1 },
  { text: "Мне нельзя отвечать", minLinks: 3, removeBelow: 2 },
  { text: "Не могу себя защитить", minLinks: 3, removeBelow: 2 },
  { text: "Нельзя дать отпор", minLinks: 3, removeBelow: 2 },
  { text: "Терпи", minLinks: 3, removeBelow: 2 }
]},
      {
        text: 'Еще несколько ударов... Я закрыла область живота левой рукой, а правой зажала нос из которого лилась кровь.',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Почему я не могу просто ударить в ответ..?", minLinks: 1, removeBelow: 1 },
  { text: "Я этого не заслужила...", minLinks: 2, removeBelow: 1 },
  { text: "Хоть бы не сломал ничего", minLinks: 3, removeBelow: 2 },
  { text: "Чтоб ты сдох!", minLinks: 9, removeBelow: 1 }
]},
      {
        text: 'Через некоторое время удары прекратились и он ушел, но я продолжала лежать на полу, чувствуя вкус крови у себя во рту.',
        play: ['click'],
        stop: []
      ,
  thoughts: [
  { text: "Больно... очень", minLinks: 2, removeBelow: 1 },
  { text: "Тошнит", minLinks: 2, removeBelow: 1 },
  { text: "Я боюсь пошевелиться", minLinks: 3, removeBelow: 1 },
  { text: "За что мне все это...", minLinks: 4, removeBelow: 1 }
]},
      {
        text: 'Кажется, сзади кто-то подходит ко мне...',
        play: ['click', 'CF377'],
        stop: [],
        thoughts:[
  { text: "Больно...", minLinks: 4, removeBelow: 2 },
  { text: "Шаги приближаются", minLinks: 6, removeBelow: 4 },
  { text: "Кто это?", minLinks: 6, removeBelow: 4 },
  { text: "Тошнит", minLinks: 4, removeBelow: 2 },
  { text: "Дальше бить будут?", minLinks: 2, removeBelow: 1 }
]
      },
      {
        text: 'Кто-то берет меня под руку и начинает поднимать с пола. Теперь я вижу - это черноволосая девушка с янтарными глазами. Она одета так же, как и я. На ее форме номер: RK-381.',
        play: ['click', 'sighwithfx'],
        stop: [],
        thoughts:[
  { text: "381...", minLinks: 4, removeBelow: 2 },
  { text: "Спасибо", minLinks: 6, removeBelow: 4 },
  { text: "Кровь все еще течет...", minLinks: 6, removeBelow: 4 },
  { text: "Значит она тоже...", minLinks: 4, removeBelow: 2 },
  { text: "Эр-Кей?", minLinks: 1, removeBelow: 1 }
]
      },
      {
        text: '<color:rk>"Зажми нос и наклони голову вперед."</color><br>Держа меня под руку, она повела меня куда-то.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Ага... Поняла", minLinks: 4, removeBelow: 2 },
  { text: "Живот болит", minLinks: 4, removeBelow: 2 },
  { text: "Почему меня побили?", minLinks: 4, removeBelow: 1 }
]
      },
      {
        text: 'Мы дошли до шлюза. Она приложила к нему свою руку и он открылся. Кажется это был туалет.<br><color:rk>"Не переживай, ты не виновата."</color><br>Мы подошли к раковине, она включила кран и начала мыть мое лицо. Вода вперемешку с кровью стекали по стенкам раковины.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Кровь", minLinks: 4, removeBelow: 2 },
  { text: "Вода прохладная", minLinks: 4, removeBelow: 2 },
  { text: "Да, я не виновата...", minLinks: 6, removeBelow: 3 },
  { text: "Кажется, крови стало поменьше", minLinks: 6, removeBelow: 3 }
]
      },
      {
        text: 'Приведя меня в порядок, она кивнула одобрительно перекрывыв кран. <br>Я подняла взгляд, посмотрев в зеркало.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Так вот, как я выгляжу...", minLinks: 4, removeBelow: 2 },
  { text: "У нас с ней глаза одинакового цвета", minLinks: 4, removeBelow: 2 },
  { text: "Кровь прошла", minLinks: 6, removeBelow: 3 },
  { text: "Я выгляжу паршиво", minLinks: 6, removeBelow: 3 },
  { text: "Ну привет, Я", minLinks: 6, removeBelow: 3 },
  { text: "Не кролик и на том спасибо", minLinks: 7, removeBelow: 6 }
]
      },
      {
        text: 'Я вздохнула и слегка улыбнулась, глядя на ее отражение.<br>- <color:cf>Спасибо, что помогла.</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Все еще больно, но уже лучше", minLinks: 4, removeBelow: 2 },
  { text: "Кажется она тоже будущий пилот", minLinks: 4, removeBelow: 2 },
  { text: "Может мы подружимся", minLinks: 6, removeBelow: 3 },
  { text: "Я выгляжу паршиво", minLinks: 6, removeBelow: 3 },
  { text: "И... Как мне реагировать на то, что она не улыбается в ответ?", minLinks: 6, removeBelow: 3 },
  { text: "Какая же она добрая!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я развернулась и попыталась сделать шаг, но в этот момент казалось бы утихшая боль в боку ударила с новой силой и я чуть не сложилась.<br>RK-381 Подставила руку и я оперлась на нее.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Какой ужас...", minLinks: 4, removeBelow: 2 },
  { text: "Больно!", minLinks: 4, removeBelow: 2 },
  { text: "Я точно в порядке?", minLinks: 6, removeBelow: 3 },
  { text: "Ходить будет больно...", minLinks: 6, removeBelow: 3 },
  { text: "Сейчас стою смирно... Вроде боль проходит", minLinks: 6, removeBelow: 3 },
  { text: "Я умира-а-а-аю...", minLinks: 8, removeBelow: 7 }
]
      },
      {
        text: '<color:rk>"Я помогу тебе дойти до класса. Идем."</color><br>Она взяла меня под руку и повела. Живот все еще болел, но идти стало легче.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Она такая добрая", minLinks: 4, removeBelow: 2 },
  { text: "Класс 45 вроде", minLinks: 4, removeBelow: 2 },
  { text: "Есть не хочется совсем... тошнит", minLinks: 3, removeBelow: 2 },
  { text: "Хочется полежать...", minLinks: 1, removeBelow: 1 }
]
      },
      {
        text: 'Пройдя через коридоры общей зоны, мы вернулись в зону для репликантов. Это заняло чуть больше времени, поскольку мне было достаточно больно идти. Черт, я ведь так и не поела.',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Хочется есть, но не хочется...", minLinks: 4, removeBelow: 2 },
  { text: "Отдохнуть бы...", minLinks: 4, removeBelow: 2 }
]},
      {
        text: 'На входе нас встретил мужчина с надписью "INSTRUCTOR" на форме. Он посмотрел на нас.<br><color:instructor>"Вы уже в паре?"</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Надо ему сказать что меня побили", minLinks: 4, removeBelow: 2 },
  { text: "А может отгул попросить?", minLinks: 2, removeBelow: 1 },
  { text: "Опять кто-то важный...", minLinks: 4, removeBelow: 2 },
  { text: "Пара? Это в каком таком смысле...", minLinks: 6, removeBelow: 3 }
]},
      {
        text: '<color:rk>"Так точно."</color><br>RK-381 Коротко кивнула и помогла мне войти в класс. Внутри было довольно много других репликантов. И, кажется, у всех были янтарные глаза... Интересно.',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Девушки...", minLinks: 1, removeBelow: 1 },
  { text: "Парни...", minLinks: 1, removeBelow: 1 },
  { text: "Хотя бы лица разные...", minLinks: 4, removeBelow: 2 },
  { text: "А эта на меня похожа!", minLinks: 6, removeBelow: 1 },
  { text: "Я опоздала?", minLinks: 4, removeBelow: 2 },
  { text: "Зато я с ней в паре!", minLinks: 4, removeBelow: 2 }
]},
      {
        text: 'Мы сели на свободные места в переднем ряду. Класс по своей сути состоит из стульев и экрана.',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Неудобно... и все болит...", minLinks: 4, removeBelow: 2 },
  { text: "Вот бы поспать...", minLinks: 4, removeBelow: 2 },
  { text: "У нас первые места!", minLinks: 4, removeBelow: 2 },
  { text: "У нас первые места... это плохо...", minLinks: 4, removeBelow: 2 }
]},
      {
        text: 'Инструктор посмотрел на часы, затем оглядел присутствующих.<br><color:instructor>"Для начала - называйте меня инструктор или сэр. Никак иначе."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Так точно, сэр", minLinks: 3, removeBelow: 2 },
  { text: "Принято, сэр", minLinks: 3, removeBelow: 2 },
  { text: "Есть, сэр", minLinks: 3, removeBelow: 2 },
  { text: "Мудак", minLinks: 9, removeBelow: 1 },
  { text: "Важный какой...", minLinks: 5, removeBelow: 4 }
]},
      {
        text: 'Он встал из-за стола и нажал переключатель рядом с экраном. Экран включился и на нем открылась картинка.<br><color:instructor>"Это - стратегическая карта человеческого сектора галактики."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Большая!", minLinks: 2, removeBelow: 1 },
  { text: "Точечки", minLinks: 4, removeBelow: 3 },
  { text: "Линии", minLinks: 4, removeBelow: 3 },
  { text: "Много всего", minLinks: 4, removeBelow: 3 },
  { text: "И все кажется знакомым", minLinks: 4, removeBelow: 1 }
]},
      {
        text: '<color:instructor>"Вы могли заметить, что большая часть секторов на этой карте отмечены красным цветом."</color><br>Он указал в верхнюю часть карты, которая была сплошь красной.<br><color:instructor>"Красный - значит оккупирован врагом."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "О нет...", minLinks: 5, removeBelow: 4 },
  { text: "Победим врага!", minLinks: 2, removeBelow: 1 },
  { text: "Но как...", minLinks: 4, removeBelow: 2 }
]},
      {
        text: '<em>Стоп... То есть почти все человеческие секторы были захвачены?</em><br>Я уставилась на карту. Инструктор выдержал паузу и тыкнул пальцем в одну из красных точек.<br><color:instructor>"Вот тут была наша столица. [[Марс|Столица ЦПСС]]. До тех пор, пока эти твари не уничтожили ее."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "О нет!", minLinks: 4, removeBelow: 2 },
  { text: "На Марсе классно", minLinks: 10, removeBelow: 1 },
  { text: "И что делать теперь?", minLinks: 4, removeBelow: 2 },
  { text: "Видимо, мстить", minLinks: 4, removeBelow: 2 }
]},
      {
        text: 'Инструктор вздохнул, убрал руку с карты и продолжил.<br><color:instructor>"Враг думал, что это сломит нас. Что заставит нас капитулировать. Но человечество не должно сдаваться. Инопланетные захватчики должны пожалеть о том, что посмели напасть на нас."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Покажем им", minLinks: 4, removeBelow: 2 },
  { text: "А... почему мы именно?", minLinks: 8, removeBelow: 2 },
  { text: "Как же спать охото... сил нет", minLinks: 6, removeBelow: 2 }
]},
      {
        text: '<color:instructor>"Вот тут..."</color><br>Он снова повернулся к карте и указал пальцем на белую точку в нижней части рядом с оккупированными территориями.<br><color:instructor>"...находимся мы. Главные силы [[ОЧС|Объединенные Человеческие Силы - Военный союз человеческих государств.]]. Здесь мы принимаем бой. И этот бой решает судьбу человечества. Система, в которой мы находимся - является ключевой. Тут сконцентрированны главные ресурсные и промышленные силы ОЧС. Враг направил сюда свой сильнейший флот. И мы прямо сейчас отбиваем его атаку."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Странно... я ничего не чувствую по этому поводу", minLinks: 3, removeBelow: 1 },
  { text: "А должна я что-то чувствовать?", minLinks: 5, removeBelow: 2 },
  { text: "Ну, видимо, будет бойня", minLinks: 6, removeBelow: 3 },
  { text: "Как же не хочется умирать...", minLinks: 9, removeBelow: 8 }
]},
      {
        text: 'Инструктор развернулся к нам.<br><color:instructor>"Если Объединенные Человеческие Силы смогут отбить эту атаку - это сможет задержать и так уже истощённого врага и дать человечеству время на подготовку к контратаке, но если мы потеряем Никс, то у человечества уже не будет шансов. Мы лишимсся наших главных ресурсов и поражение будет лишь вопросом времени... По этому мы должны показать врагу ад. Мы должны сделать все, для того, чтобы отбить эту атаку. И если мы сможем - это будет первой победой человечества, которая положит начало освобождению от гнёта захватчика."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "И в центре этого ада, видимо, мы", minLinks: 8, removeBelow: 6 },
  { text: "Сделаем это", minLinks: 4, removeBelow: 2 },
  { text: "Сделаем... после небольшого отдыха...", minLinks: 6, removeBelow: 4 }
]},
      {
        text: '<color:instructor>"Вы тоже внесете свой вклад в бой..."</color>',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Хорошо, сэр", minLinks: 4, removeBelow: 2 },
  { text: "Принято, сэр", minLinks: 4, removeBelow: 2 },
  { text: "Есть, сэр", minLinks: 4, removeBelow: 2 },
  { text: "Есть хочется...", minLinks: 6, removeBelow: 1 },
  { text: "Хочется вздремнуть...", minLinks: 6, removeBelow: 1 },
  { text: "Умирать не охото", minLinks: 8, removeBelow: 7 },
  { text: "Так точно, сэр", minLinks: 4, removeBelow: 2 },
  { text: "Ну конечно, заплатим цену, только не они, а я", minLinks: 9, removeBelow: 4 },
  { text: "Это не справедливо", minLinks: 9, removeBelow: 1 }
]},
      {
        text: 'Я прикрываю глаза. Как много всего произошло за пару часов...',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Инструктор говворил...", minLinks: 4, removeBelow: 2 },
  { text: "Про что он там говорил?", minLinks: 4, removeBelow: 2 },
  { text: "Про инструктаж...", minLinks: 4, removeBelow: 2 },
  { text: "У него приятный голос...", minLinks: 6, removeBelow: 4 }
]
      },
      {
        text: 'Внезапная резкая боль в боку заставляет меня открыть глаза.',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Больно!", minLinks: 4, removeBelow: 2 },
  { text: "Опять бьют", minLinks: 4, removeBelow: 2 },
  { text: "Может я это заслужила?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Проморгавшись я вижу перед собой девушку с янтарными глазами. Кажется она чем-то недовольна и снова пихает меня в бок...',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "А, это она", minLinks: 4, removeBelow: 2 },
  { text: "Хватит бить, дура. Больно", minLinks: 4, removeBelow: 2 },
  { text: "Какая же она злая", minLinks: 4, removeBelow: 2 },
  { text: "Ладно, я заслужила", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Смирив меня строгим взглядом, RK-381 кивнула перед собой. Я посмотрела вперед.',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Точно... Инструктаж", minLinks: 4, removeBelow: 2 },
  { text: "Я все пропустила уже?", minLinks: 4, removeBelow: 2 },
  { text: "А про что нам говорили?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Экран был уже выключен.<br><color:instructor>"Это далеко не все, что вам нужно знать. Остальное вы узнаете на следующих инструктажах."</color>',
        play: ['click'],
        stop: ['music1'],
        thoughts: [
  { text: "Я действительно все пропустила...", minLinks: 4, removeBelow: 2 },
  { text: "Тут не было ничего важного, наверное", minLinks: 4, removeBelow: 2 },
  { text: "Остальные инструктажи? О нет...", minLinks: 8, removeBelow: 6 }
]
      },
      {
        text: 'День за днем мы проходили тоскливые инструктажи...',
        play: ['click', 'insolitum'],
        stop: [],
        thoughts:[
  
]
      },
      {
        text: 'Теперь я была более внимательной идя по коридорам. Несколько раз я снова видела того инженера. Больше он на меня внимания не обращал.',
        play: ['click'],
        stop: [],
        thoughts: [
  { text: "Он даже не извинился", minLinks: 4, removeBelow: 2 },
  { text: "Вот бы его отпиздить!", minLinks: 1, removeBelow: 1 },
  { text: "Он выглядит намного сильнее меня...", minLinks: 5, removeBelow: 3 },
  { text: "Нужно мне смотреть по сторонам", minLinks: 4, removeBelow: 2 },
  { text: "Пронесло...", minLinks: 4, removeBelow: 2 },
  { text: "С прошлого раза бок еще болит", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Среди всех, кого я тут видела - Алиса казалась самой доброй. Как будто ей не место на этом корабле. Остальной экипаж относился к репликантам в лучшем случае безразлично.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "И чем я все это заслужила?", minLinks: 4, removeBelow: 2 },
  { text: "Они разве не должны быть нам благодарны?", minLinks: 5, removeBelow: 3 },
  { text: "Это их война", minLinks: 7, removeBelow: 4 },
  { text: "Мне все это не нужно", minLinks: 6, removeBelow: 4 },
  { text: "Я не просила меня делать", minLinks: 4, removeBelow: 2 },
  { text: "Не справедливо...", minLinks: 6, removeBelow: 4 },
  { text: "Пусть сами воюют вообще!", minLinks: 8, removeBelow: 6 }
]
      },
      {
        text: 'Каждый день мы проходили инструктажи и всевозможные курсы. Некоторые курсы были весьма даже интересными, но инструктажи... На них я иногда засыпала.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Угол разворота основных орудий...", minLinks: 4, removeBelow: 2 },
  { text: "Калибр... угу...", minLinks: 4, removeBelow: 2 },
  { text: "Цифры-цифры-цифры", minLinks: 4, removeBelow: 2 },
  { text: "Толщина брони", minLinks: 4, removeBelow: 2 },
  { text: "Силуэт вражеской техники", minLinks: 4, removeBelow: 2 },
  { text: "Максимальная тяга движков...", minLinks: 4, removeBelow: 2 },
  { text: "Дальность действия коммуникационного реле", minLinks: 4, removeBelow: 2 },
  { text: "Колличество палуб Техлина", minLinks: 4, removeBelow: 2 },
  { text: "Что такое корма?", minLinks: 4, removeBelow: 2 },
  { text: "Гальюн... смешное слово!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'После занятий мы с RK-381 возвращались в каюту. Каюта была совсем маленькой. Настолько, что протиснуться в нее мы могли только по очереди.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Она мне опять на ногу наступила...", minLinks: 4, removeBelow: 2 },
  { text: "И смотрит потом так будто я виновата!", minLinks: 4, removeBelow: 2 },
  { text: "Но зато извинилась", minLinks: 4, removeBelow: 2 },
  { text: "Добрая", minLinks: 4, removeBelow: 2 },
  { text: "А взгляд у нее строгий", minLinks: 4, removeBelow: 2 },
  { text: "И вредная она вообще", minLinks: 4, removeBelow: 2 },
  { text: "Или важная?", minLinks: 4, removeBelow: 2 },
  { text: "Ну хоть не храпит!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Но кроме нас в каюте никого не было и моя соседка была настолько тихой и незаметной, что казалось, будто я живу одна...',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Как-то одиноко...", minLinks: 4, removeBelow: 2 },
  { text: "Она толком и не говорит ни о чем", minLinks: 4, removeBelow: 2 },
  { text: "Зато не ругается", minLinks: 4, removeBelow: 2 },
  { text: "Надо бы её разговорить", minLinks: 4, removeBelow: 2 },
  { text: "Интересно, а о чем она думает?", minLinks: 4, removeBelow: 2 },
  { text: "А почему я так много говорю?", minLinks: 4, removeBelow: 2 },
  { text: "Вот бы она болтливой была", minLinks: 4, removeBelow: 2 },
  { text: "Скучно...", minLinks: 0, removeBelow: 0 }
]
      },
      {
        text: 'Мы так много проводим времени вместе, но до сих пор толком ничего друг о друге не знаем. Так что я решила сделать первый шаг.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Нужно спросить...", minLinks: 4, removeBelow: 2 },
  { text: "Нет, нужно просто сказать...", minLinks: 4, removeBelow: 2 },
  { text: "Вот ничего в голову не приходит", minLinks: 4, removeBelow: 2 },
  { text: "А как люди разговор начинают?", minLinks: 4, removeBelow: 2 },
  { text: "Скажу что нибудь нейтральное", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK-381 буднично занимается своим макияжем перед зеркалом. Она это делает каждое утро.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Вот делать ей нечего!", minLinks: 4, removeBelow: 2 },
  { text: "И к чемуона этим занята?", minLinks: 4, removeBelow: 2 },
  { text: "Хотя, ей идет", minLinks: 4, removeBelow: 2 },
  { text: "Выглядит важной", minLinks: 4, removeBelow: 2 },
  { text: "Слишком важной", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:cf>"Как жизнь?"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Вроде нормальный вопрос", minLinks: 4, removeBelow: 2 },
  { text: "Нейтрально и ненавязчиво", minLinks: 4, removeBelow: 2 },
  { text: "У неё ресница странно дернулась...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Отражение RK резко зыркнуло на меня, приподнимая бровь, которую только что подводила. Она молчит...',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Слишком важная", minLinks: 4, removeBelow: 2 },
  { text: "Да что не так снова то?", minLinks: 4, removeBelow: 2 },
  { text: "Вот и как с ней вообще разговор завести?", minLinks: 4, removeBelow: 2 },
  { text: "Какая же она вредная...", minLinks: 4, removeBelow: 2 },
  { text: "Вот кто так вообще на людей смотрит?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Как-то неловко получается... Может сразу к делу?<br><color:cf>"Ну... В общем... Мы толком и не знакомились..."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Вот так даже лучше", minLinks: 4, removeBelow: 2 },
  { text: "Я бы и Восхождением могла подружиться", minLinks: 4, removeBelow: 2 },
  { text: "Должно сработать", minLinks: 4, removeBelow: 2 },
  { text: "Она так поймет, что ей тоже нужно говорить", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:rk>"А о чем нам с тобой говорить? Может о нашем прошлом?"</color><br>В сравнении с ее лицом, обшивка каюты выглядит более доброжелательной.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Какая же она злая...", minLinks: 4, removeBelow: 2 },
  { text: "Да о чем угодно говорить!", minLinks: 4, removeBelow: 2 },
  { text: "Она будто не рада что я её напарница", minLinks: 4, removeBelow: 2 },
  { text: "Просто... невозможно", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<em>Блин, точно... И о чем мне ее спросить...</em><br>Мой взгляд цепляется за тушь в ее руке.<br><color:cf>"Почему ты красишься? И откуда вообще у тебя косметика?"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Вот бы ей в крашенный глаз двинуть!", minLinks: 9, removeBelow: 8 },
  { text: "Может попросить её накрасить меня?", minLinks: 4, removeBelow: 4 },
  { text: "И все то я должна строить диалог...", minLinks: 4, removeBelow: 0 },
  { text: "Сама бы спросила лучше чего!", minLinks: 6, removeBelow: 4 },
  { text: "Только я говорю и я, нет сил уже...", minLinks: 9, removeBelow: 8 }
]
      },
      {
        text: '<color:rk>"Досталась от Алисы. Мне было интересно почему у нее такие выразительные глаза. Она ответила, что и мне можно такие сделать... Показала как краситься и оставила немного косметики. Хоть какой-то смысл есть вставать пораньше"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Алиса... она добрая!", minLinks: 4, removeBelow: 2 },
  { text: "Идет ей косметика, конечно", minLinks: 4, removeBelow: 2 },
  { text: "Может попросить меня накрасить?", minLinks: 4, removeBelow: 2 },
  { text: "Ой нет, лень мне каждый день возиться у зеркала...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:rk>"Ну а ты чем занята помимо крепкого сна на инструктажах?"</color><br>Она сделала небольшую паузу, затем отвечает на свой вопрос:<br><color:rk>"Ничем."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Какая же она грубая!", minLinks: 4, removeBelow: 2 },
  { text: "Да откуда она знает чем я занята...", minLinks: 4, removeBelow: 2 },
  { text: "А чем я занимаюсь, действительно...", minLinks: 4, removeBelow: 2 },
  { text: "Вообще я учусь", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<em>Она меня пристыдить сейчас пытается?</em><br><color:cf>"Ну вообще-то я... я... "</color><br>Ничего дельного на ум не приходит... Мой взгляд бегает по каюте, пытаясь зацепиться за что-то.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Мыло", minLinks: 4, removeBelow: 2 },
  { text: "Душ", minLinks: 4, removeBelow: 2 },
  { text: "Раковина", minLinks: 4, removeBelow: 2 },
  { text: "И не стыдно ей в одном нижнем белье?", minLinks: 4, removeBelow: 2 },
  { text: "Хоть бы футболку накинула...", minLinks: 4, removeBelow: 2 },
  { text: "Я вот вообще порой прямо в одежде сплю", minLinks: 4, removeBelow: 2 },
  { text: "Пол холодный...", minLinks: 4, removeBelow: 2 },
  { text: "Кажется, лампочка скоро сгорит", minLinks: 4, removeBelow: 2 },
  { text: "Болтик от обшивки отвалился...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Но взгляд не цепляется ни за что кроме RK и ее разочарованного взгляда в отражении зеркала.<br><em>Нужно быстрее придумать что ответить...</em>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Я рисую", minLinks: 4, removeBelow: 2 },
  { text: "Я пилотировать штурмовика буду", minLinks: 2, removeBelow: 0 },
  { text: "Я готовить люблю", minLinks: 4, removeBelow: 2 },
  { text: "Я тебе щас в глаз двину, коза крашенная", minLinks: 9, removeBelow: 8 },
  { text: "Я люблю музыку слушать", minLinks: 4, removeBelow: 2 },
  { text: "Я люблю читать", minLinks: 4, removeBelow: 2 },
  { text: "Я знаю кунг-фу!", minLinks: 8, removeBelow: 6 },
  { text: "Я занята разработкой вакцины против КРС", minLinks: 8, removeBelow: 6 },
  { text: "Я изучаю медицинское дело", minLinks: 6, removeBelow: 4 },
  { text: "Я создаю чертежи для судов!", minLinks: 6, removeBelow: 4 },
  { text: "Я петь умею", minLinks: 4, removeBelow: 2 },
  { text: "И вообще, красить глазки это не хобби!", minLinks: 2, removeBelow: 1 },
  { text: "Как-то вообще ничего правдивого на ум не приходит...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:cf>"А я думаю много!"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "...", minLinks: 4, removeBelow: 2 },
  { text: "... ", minLinks: 4, removeBelow: 2 },
  { text: "...  ", minLinks: 4, removeBelow: 2 },
  { text: "...   ", minLinks: 4, removeBelow: 2 },
  { text: " ...", minLinks: 4, removeBelow: 2 },
  { text: "  ...", minLinks: 4, removeBelow: 2 },
  { text: "   ... ", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Наконец RK поворачивается ко мне лицом, полным искреннего удивления.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Сработало..?", minLinks: 4, removeBelow: 2 },
  { text: "Может она просто не думает?", minLinks: 4, removeBelow: 2 },
  { text: "Вдруг у меня дар?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '...',
        play: ['click'],
        stop: [],
        thoughts:[
  
]
      },
      {
        text: '<color:rk>"Ясно"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Блин...", minLinks: 4, removeBelow: 2 },
  { text: "Я дура", minLinks: 4, removeBelow: 2 },
  { text: "Надо что-то еще придумать", minLinks: 4, removeBelow: 2 },
  { text: "Какая же она холодная...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Этот позор был прерван звуковым сигналом, оповещающим о скором начале занятий.',
        play: ['click', 'alarm1'],
        stop: [],
        thoughts:[
  { text: "Я спасена!", minLinks: 4, removeBelow: 2 },
  { text: "Вот бы еще подремать...", minLinks: 4, removeBelow: 2 },
  { text: "Позавтракать бы...", minLinks: 4, removeBelow: 2 },
  { text: "Уже пора?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<em>Сейчас должно пройти первое занятие с использованием импланта... Интересно как оно будет проходить?</em><br><br><color:rk>"Нам пора"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Надеюсь, это будет интересно", minLinks: 4, removeBelow: 2 },
  { text: "Как-то даже не тревожно совсем", minLinks: 4, removeBelow: 2 },
  { text: "А вдруг у меня талант в управлении штурмовиком?", minLinks: 4, removeBelow: 2 },
  { text: "Покажу ей все на что способна!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Нас посадили в кабину штурмовика. Я нахожусь в окружении множества тумблеров, кнопок и табло. Слева от меня в кресле первого пилота уверенно расположилась RK. И похоже ее не смущает то, что на нас сидят довольно дискомфортные облегающие костюмы с кучей проводов и каких-то присосок. Через открытую кабину к нам заглядывает Алиса и доброжелательно улыбаясь, подключает костюмы к мейнфрейму симулятора через еще больше проводов.',
        play: ['click'],
        stop: ['alarm1'],
        thoughts:[
  { text: "И почему эти костюмы... такие?", minLinks: 4, removeBelow: 2 },
  { text: "Чувствую себя неловко...", minLinks: 4, removeBelow: 2 },
  { text: "Стыдно...", minLinks: 4, removeBelow: 2 },
  { text: "А ей все равно абсолютно!", minLinks: 4, removeBelow: 2 },
  { text: "Провод в кожу впился...", minLinks: 4, removeBelow: 2 },
  { text: "И эти... липучки... ужасно...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:alice>"Девченки, привет. Сегодня у вас важный день. 381, прекрасно выглядишь."</color><br>После этих слов она протягивает нам гарнитуры.<br><color:alice>"Я вас проинструктирую насчет импланта."</color><br>Передав гарнитуры, Алиса похлопала меня по плечу и удалилась, закрыв дверь кабины.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "А я плохо выгляжу?", minLinks: 4, removeBelow: 2 },
  { text: "Я даже в зеркало сегодня не посмотрелась...", minLinks: 4, removeBelow: 2 },
  { text: "Да я всегда прекрасно выгляжу!", minLinks: 4, removeBelow: 2 },
  { text: "Какая-же она добрая", minLinks: 4, removeBelow: 2 },
  { text: "Ага... имплант? Точно...", minLinks: 4, removeBelow: 2 },
  { text: "Может попросить её другие костюмы нам дать?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Приборные панели оживают, загораясь огнями. От чего количества тумберов, кнопок и разных табло у меня разбегаются глаза... <em>А ведь я должна была всё это запомнить на занятиях...</em>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Красиво!", minLinks: 0, removeBelow: 0 },
  { text: "И этим мне надо управлять?", minLinks: 0, removeBelow: 0 },
  { text: "А это что такое мигает?", minLinks: 0, removeBelow: 0 },
  { text: "Голова кругом...", minLinks: 0, removeBelow: 0 },
  { text: "И этот... костюм... мне сосредоточиться не позволяет!", minLinks: 0, removeBelow: 0 },
  { text: "Ага, ну что такое Eject я знаю... только кнопка сломанна...", minLinks: 0, removeBelow: 0 },
  { text: "А вот это знакомое... нет... нет, что это?", minLinks: 0, removeBelow: 0 }
]
      },
      {
        text: 'Я поворачиваю голову, смотря на RK. Она пробегается по панели и ловко переключает несколько тумблеров как будто понимает как всем этим пользоваться.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Какая она умная!", minLinks: 4, removeBelow: 2 },
  { text: "Ну она мне все объяснит", minLinks: 4, removeBelow: 2 },
  { text: "И откуда она все это знает?", minLinks: 4, removeBelow: 2 },
  { text: "А может просто вид делает?", minLinks: 4, removeBelow: 2 },
  { text: "Дернуть случайный тумблер?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:cf>"Так... и... Что мы теперь делаем?"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  
]
      },
      {
        text: 'В ответ RK лишь многозначительно постучала по саоему виску пальцем, не отрываясь от оперирования контрольной панелью.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "И что это значит вообще?", minLinks: 4, removeBelow: 2 },
  { text: "Какая-же она молчаливая...", minLinks: 4, removeBelow: 2 },
  { text: "Ну а мне то что делать?", minLinks: 4, removeBelow: 2 },
  { text: "Может просто сидеть?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:rk>"Активирую систему боевой поддержки..."</color><br>Прекратив тыкать на кнопочки, RK выжидающе смотрит на меня.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "А?", minLinks: 4, removeBelow: 2 },
  { text: "На голосовом управлении?", minLinks: 4, removeBelow: 2 },
  { text: "А имплант тогда зачем?", minLinks: 4, removeBelow: 2 },
  { text: "И чего она смотрит..?", minLinks: 4, removeBelow: 2 },
  { text: "Она ведь... не пялится на меня?", minLinks: 8, removeBelow: 6 },
  { text: "Вот всегда она так", minLinks: 4, removeBelow: 2 },
  { text: "Может имплант позволяет мысли читать?", minLinks: 4, removeBelow: 2 },
  { text: "На ум ну вообще ничего не приходит", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<em>Кажется... Я должна сделать... Что-то?</em><br><color:cf>"Активирую систему поддержкки...?"</color><br>Я уставилась на RK в ответ. Наверное, я выгляжу беспомощно, поскольку именно так я себя и чувствую.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Ну скажи что нибудь!", minLinks: 4, removeBelow: 2 },
  { text: "Чего она от меня ждет вообще?", minLinks: 4, removeBelow: 2 },
  { text: "Может сработает?", minLinks: 4, removeBelow: 2 },
  { text: "А может я бракованная?", minLinks: 4, removeBelow: 2 },
  { text: "Не хочу в утиль...", minLinks: 4, removeBelow: 2 },
  { text: "Может меня в уборщики перевести?", minLinks: 4, removeBelow: 2 },
  { text: "Не вышел из меня пилот...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK кивнула мне в ответ и переведя свой взгляд на главный экран, начала перемещать свой взгляд по нему. Перекрестие прицела ответило ей взаимностью, перемещаясь от одной красной точки к другой.<br>Я смотрела на это с полнейшим непониманием того, как сделать тоже самое.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Как же ей все легко дается...", minLinks: 4, removeBelow: 2 },
  { text: "Ну вот и как она это сделала?", minLinks: 4, removeBelow: 2 },
  { text: "А вдруг она будет стрелять, а я буду... другое делать?", minLinks: 4, removeBelow: 2 },
  { text: "И вообще я не создана для насилия", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Гарнитура зашипела мягким голосом Алисы.<br><color:alice>"355, представь, будто ты целишься во врага через этот экран и когда сведешь перекрестие, представь как нажимаешь на спусковой крючок."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Какого врага?", minLinks: 4, removeBelow: 2 },
  { text: "Спусковой..? А, эта штука как на пушках... оружии?", minLinks: 4, removeBelow: 2 },
  { text: "Ну что такое перекрестие я знаю!", minLinks: 4, removeBelow: 2 },
  { text: "И как это вообще через экран целится?", minLinks: 4, removeBelow: 2 },
  { text: "Не понимаю...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я таращусь на экран со всей силы, но он не отвечают мне взаимностью.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Враги!", minLinks: 4, removeBelow: 2 },
  { text: "Ура..?", minLinks: 4, removeBelow: 2 },
  { text: "В бой?", minLinks: 4, removeBelow: 2 },
  { text: "Застрелить экран", minLinks: 4, removeBelow: 2 },
  { text: "Воюй давай!", minLinks: 4, removeBelow: 2 },
  { text: "Глазки болят теперь...", minLinks: 6, removeBelow: 4 },
  { text: "Да какие враги то хоть...", minLinks: 8, removeBelow: 6 },
  { text: "Вот помог бы кто лучше...", minLinks: 8, removeBelow: 6 }
]
      },
      {
        text: 'RK прикрывает ладонью микрофон и наклоняясь ко мне ближе, полушепотом говорит:<br><color:rk>"Сфокусируйся на любой точке на экране, и когда перекрестие появится, веди его к красным квадратам. Возненавидь этот квадрат..."</color><br>Она делает небольшую паузу и еще тише проговаривает:<br><color:rk>"Вспомни того инженера... Думаю, тебе это поможет."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Какая-же она мудрая", minLinks: 4, removeBelow: 2 },
  { text: "Ну хоть кто-то подсказал нормально...", minLinks: 4, removeBelow: 2 },
  { text: "Уже понятней", minLinks: 4, removeBelow: 2 },
  { text: "Нужно попробовать", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я ищу на экране хоть что-нибудь на чем может сфокусироваться мой взгляд...',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Битый пиксель...", minLinks: 1, removeBelow: 1, interactive: true },
  { text: "Пыль какая-то...", minLinks: 3, removeBelow: 1 },
  { text: "Лампочки мигают... нет, это на панели", minLinks: 2, removeBelow: 1 },
  { text: "Да не могу я думать... мне провода в тело впились!", minLinks: 4, removeBelow: 1 },
  { text: "Есть охота...", minLinks: 4, removeBelow: 2 },
  { text: "Пахнет тут очень странно", minLinks: 4, removeBelow: 2 },
  { text: "Ну вот экран как экран", minLinks: 4, removeBelow: 2 },
  { text: "Может просто смотреть на экран долго?", minLinks: 4, removeBelow: 2 },
  { text: "Ничего не происходит...", minLinks: 4, removeBelow: 2 },
  { text: "Как же сложно!", minLinks: 4, removeBelow: 2 },
  { text: "И кто это придумал вообще?", minLinks: 4, removeBelow: 2 },
  { text: "А может я не хочу?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Вдруг всплывает перекрестие центр которого точно совпадает с положением битого пикселя. Я веду взгляд до одного из квадратов... Перекрестие подчиняется мне.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Ого!", minLinks: 2, removeBelow: 1 },
  { text: "Удобно!", minLinks: 2, removeBelow: 1 },
  { text: "Я смогла!", minLinks: 2, removeBelow: 1 },
  { text: "Классно!", minLinks: 2, removeBelow: 1 },
  { text: "А это становится веселее", minLinks: 4, removeBelow: 2 },
  { text: "Не так и сложно оказалось...", minLinks: 4, removeBelow: 2 },
  { text: "Этот костюм меня убивает...", minLinks: 4, removeBelow: 1 }
]
      },
      {
        text: '<em>Нужно уничтожить квадрат...</em>',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Инженер!", minLinks: 1, removeBelow: 1, interactive: true },
  { text: "Смерть врагам человечества!", minLinks: 6, removeBelow: 4 },
  { text: "Вообще, мне этот квадрат вот ничего не сделал", minLinks: 4, removeBelow: 2 },
  { text: "Умри..?", minLinks: 2, removeBelow: 0 },
  { text: "Пиу!?", minLinks: 2, removeBelow: 0 },
  { text: "Стреляй давай...", minLinks: 4, removeBelow: 2 },
  { text: "Ну не хочу я вот... и все тут!", minLinks: 6, removeBelow: 4 },
  { text: "Зачем мне это вообще нужно?", minLinks: 8, removeBelow: 6 },
  { text: "Насилие - это плохо", minLinks: 8, removeBelow: 6 }
]
      },
      {
        text: 'Квадрат исчезает, а в голове что-то приятно щелкает и я чувствую какое-то странное удовлетворение, будто я действительно дала отпор своему обидчику. Хочется еще...',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Есть!", minLinks: 4, removeBelow: 2 },
  { text: "У меня получилось!", minLinks: 4, removeBelow: 2 },
  { text: "Это весело!", minLinks: 4, removeBelow: 2 },
  { text: "Еще нужно один уничтожить!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'От оглушительной тревоги я потеряла концентрацию и перекрестие исчезло.',
        play: ['click', 'big_alarm'],
        stop: ['insolitum'],
        thoughts:[
  { text: "А?!", minLinks: 4, removeBelow: 2 },
  { text: "Уши...", minLinks: 4, removeBelow: 2 },
  { text: "Что это за шум?", minLinks: 4, removeBelow: 2 },
  { text: "Это не к добру...", minLinks: 4, removeBelow: 2 },
  { text: "У меня только получаться начало", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Не успела я задаться вопросом "Что происходит?", как система оповещение скомандовала:<br>"Всем пилотам желтого звена - заять кабины штурмовиков и немедленно начать вылет на боевую задачу!"',
        play: ['click', 'part3'],
        stop: [],
        thoughts:[
  { text: "Желтое... звено? Это мы", minLinks: 4, removeBelow: 2 },
  { text: "А мы уже в кабинах!", minLinks: 4, removeBelow: 2 },
  { text: "Вообще... я довольно спокойна", minLinks: 4, removeBelow: 2 },
  { text: "Видимо, вот и все обучение", minLinks: 4, removeBelow: 2 },
  { text: "Наверное, по ходу разберемся", minLinks: 4, removeBelow: 2 },
  { text: "А как же тренировка?", minLinks: 4, removeBelow: 2 },
  { text: "Что еще за боевая задача..?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Пока звучит оповещение, RK-381 быстрыми движениями вырывает из мейнфрейма симулятора сначала свой, а потом мой штекер и подключает их к совершенно другой панели. В этот момент я чувствую... штурмовик..?<br>"В непосредственной близости от нас из блюспейс пространства вышла ударная группа сил Восхождения. Пилотам штурмовиков необходимо принять удар на себя!"',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Ай, не приятно!", minLinks: 4, removeBelow: 2 },
  { text: "Я чувствую... тяжесть...", minLinks: 4, removeBelow: 2 },
  { text: "Мы летим в бой...", minLinks: 4, removeBelow: 2 },
  { text: "Хоть бы все вышло...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Пытаясь перекричать голос анонсирующего, RK скомандовала:<br><color:rk>"Запусти двигатель штурмовика!"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "А как?!", minLinks: 4, removeBelow: 2 },
  { text: "А, вот этот... нет, не эта кнопка", minLinks: 4, removeBelow: 2 },
  { text: "Сама бы и запустила...", minLinks: 4, removeBelow: 2 },
  { text: "Как же она любит командовать...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<em>Так... Запустить двигатель...</em>',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Оживи!", minLinks: 4, removeBelow: 2, interactive: true },
  { text: "Работай...", minLinks: 4, removeBelow: 2 },
  { text: "Запускайся", minLinks: 4, removeBelow: 2 },
  { text: "Полетели?", minLinks: 4, removeBelow: 2 },
  { text: "Вот бы этот костюм снять уже...", minLinks: 8, removeBelow: 6 },
  { text: "Вж-ж-ж?", minLinks: 6, removeBelow: 4 },
  { text: "А он заправлен вообще?", minLinks: 10, removeBelow: 8 }
]
      },
      {
        text: 'Что-то под штурмовиком щелкнуло и загудело. Боевая машина начала опускаться вниз и оказалась под ангаром. Тут очень темно, а когда отверстие сверху захлопнулось - темнота стала кромешной.',
        play: ['click', 'door_opening', 'launching'],
        stop: ['big_alarm'],
        thoughts:[
  { text: "О-о-о!", minLinks: 4, removeBelow: 2 },
  { text: "Ой...", minLinks: 4, removeBelow: 2 },
  { text: "А?", minLinks: 4, removeBelow: 2 },
  { text: "Ага...", minLinks: 4, removeBelow: 2 },
  { text: "Так...", minLinks: 4, removeBelow: 2 },
  { text: "Угу-м...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'В гарнитуре раздаются почти в унисон голоса других пилотов:<br>"Штурмовик 4 вылетел!"<br>"Штурмовик 6 вылетел!"<br>"Штурмовик 7 вылетел!"',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Синхронно!", minLinks: 4, removeBelow: 2 },
  { text: "А мы... 10 штурмовик, вроде?", minLinks: 4, removeBelow: 2 },
  { text: "Вот бы это кончилось поскорей", minLinks: 4, removeBelow: 2 },
  { text: "Видимо, обучения больше не будет...", minLinks: 4, removeBelow: 2 },
  { text: "А может это такое обучение и есть?", minLinks: 4, removeBelow: 2 },
  { text: "Хоть бы это все не в заправду...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Перед нами открылся шлюз, заполняя пространство блеклым светом. Наш штурмовик сорвался с места и в иллюминаторе на черном космосе начали проявляться едва заметные звезды.<br>RK говорит:<br><color:rk>"Штурмовик 10 вылетел"</color><br>Ее слова дулировались в гарнитуре.',
        play: ['click', 'take_off'],
        stop: [],
        thoughts:[
  { text: "Какая она собранная!", minLinks: 4, removeBelow: 2 },
  { text: "Жаль не я скомандовала...", minLinks: 4, removeBelow: 2 },
  { text: "Кажется, она первый пилот...", minLinks: 4, removeBelow: 2 },
  { text: "Эх, а я всего-ли вторая...", minLinks: 4, removeBelow: 2 },
  { text: "Голова закружилась...", minLinks: 4, removeBelow: 2 },
  { text: "Мне от ускорения еще сильнее провода впились!", minLinks: 8, removeBelow: 6 }
]
      },
      {
        text: 'Наконец собравшись с мыслями я нажимаю на кнопку на панели и включаю радар. На экране начинают появляться бесчисленные вражеские сигнатуры, а Телхин судя по всему стал удаляться.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Такое чувство... будто я стала меньше весить...", minLinks: 4, removeBelow: 2 },
  { text: "Их... очень много!", minLinks: 4, removeBelow: 2 },
  { text: "И это вот всех их надо перестрелять?", minLinks: 4, removeBelow: 2 },
  { text: "Хочется уже обратно вернуться...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Судя по всему RK взяла на себя органы управления штурмовика и мы начали формировать построение с другими боевыми машинами.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Нас тоже много!", minLinks: 4, removeBelow: 2 },
  { text: "Наверняка мы сильнее", minLinks: 4, removeBelow: 2 },
  { text: "Как ровно выстроились...", minLinks: 4, removeBelow: 2 },
  { text: "Какая же она умелая!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Дружеские сигнатуры построились в форме обратного клина и мы находились примерно в середине.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Может мы и не первые в бой пойдем?", minLinks: 4, removeBelow: 2 },
  { text: "Особо и не нервничаю... ", minLinks: 4, removeBelow: 2 },
  { text: "Ну думаю справимся", minLinks: 4, removeBelow: 2 },
  { text: "Нас будут наверняка прикрывать", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Наши силы находились на удалении от вражеских сигнатур, когда как сигнатура Телхина уходила все дальше от нас. Гарнитура заговорила:<br>"Первый штурмовик берет под себя командование операцией. Мы будем наносить точечные удары по силам противника, угрожающим Телхину. Нам нужно продержаться до подкрепления с передовой."',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Первый это командир... удобно!", minLinks: 4, removeBelow: 2 },
  { text: "И у нас план есть", minLinks: 4, removeBelow: 2 },
  { text: "Ну все точно будет хорошо", minLinks: 4, removeBelow: 2 },
  { text: "Раз он так уверен, то я уже и не переживаю совсем", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'На радаре я вижу, как на нас надвигается целый рой мелких красных точек.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Так они маленькие совсем", minLinks: 4, removeBelow: 2 },
  { text: "Наверняка легко будет", minLinks: 4, removeBelow: 2 },
  { text: "Раз их много, значит слабые", minLinks: 4, removeBelow: 2 },
  { text: "У них и плана никакого нет, видимо", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '"Пятый, восьмой и десятый - возьмите на себя дроны на левом фланге, двадцать второй, второй и седьмой - на правом"',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Э-э-э... десятый? Это я", minLinks: 4, removeBelow: 2 },
  { text: "Мне ответить?", minLinks: 4, removeBelow: 2 },
  { text: "Или молчать?", minLinks: 4, removeBelow: 2 },
  { text: "Или она ответит?", minLinks: 4, removeBelow: 2 },
  { text: "Ну она тут главная, разберется", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Наш штурмовик покинул построение и набрав скорость полетел к группе дронов.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Чувствую... нетерпение?", minLinks: 4, removeBelow: 2 },
  { text: "Да, мы точно справимся", minLinks: 4, removeBelow: 2 },
  { text: "Вряд-ли это так сложно", minLinks: 4, removeBelow: 2 },
  { text: "Разберемся и вернемся на Телхин", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK не отрывая взгляда со своих приборов говорит мне:<br><color:rk>"Сфокусируйся на уничтожении противника"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Ну вот у нас и задачи поделены", minLinks: 4, removeBelow: 2 },
  { text: "Стрелять то я уже умею!", minLinks: 4, removeBelow: 2 },
  { text: "Вот как спросит в следующий раз чем я занимаюсь...", minLinks: 4, removeBelow: 2 },
  { text: "Наверняка это мое призвание", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<em>Нужно сфокусироваться на...</em>',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Битый пиксель", minLinks: 4, removeBelow: 2, interactive: true },
  { text: "Проклятый костюм...", minLinks: 4, removeBelow: 2 },
  { text: "Как-то подташнивает", minLinks: 4, removeBelow: 2 },
  { text: "Почему-то я едва кресло чувствую", minLinks: 4, removeBelow: 2 },
  { text: "Ноги затекли", minLinks: 4, removeBelow: 2 },
  { text: "Так... навестись на...", minLinks: 4, removeBelow: 2 },
  { text: "Спать перехотелось", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я снова фокусирюсь на битом пикселе на интерфейсе орудий и там появляется перекрестие. Я веду свой взгляд и чувствую, как орудия с трудом поддаются мне, в конце концов наводясь на противника.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Легче стало...", minLinks: 4, removeBelow: 2 },
  { text: "Орудия так медленно разворачиваются", minLinks: 4, removeBelow: 2 },
  { text: "Стало сложнее...", minLinks: 4, removeBelow: 2 },
  { text: "Пока справляюсь", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Мы подлетели достаточно близко и теперь...',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Инженер", minLinks: 1, removeBelow: 1, interactive: true },
  { text: "Быстрые они...", minLinks: 4, removeBelow: 2 },
  { text: "Руки вспотели немного...", minLinks: 4, removeBelow: 2 },
  { text: "А если они стрелять будут в ответ?", minLinks: 4, removeBelow: 2 },
  { text: "Может предупредительный... нет-нет, надо стрелять сразу!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'С удивительной точностью очереди автоматических орудий поражали одну цель за другой, стерая их с радаров. Другие штурмовики из нашей группы тоже подключились и вскоре небольшой рой дронов был полностью уничтожен.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Ха!", minLinks: 4, removeBelow: 2 },
  { text: "Легко", minLinks: 4, removeBelow: 2 },
  { text: "Это точно мое призвание", minLinks: 4, removeBelow: 2 },
  { text: "Надеюсь, она мной гордится", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Наш штурмовик сменил курс и мы начали возвращаться к основному построению. Из гарнитуры раздалось:<br>"Отлично. Первая группа - возвращайтесь в..."',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "В куда?", minLinks: 4, removeBelow: 2 },
  { text: "Что-то промелькнуло в космосе...", minLinks: 4, removeBelow: 2 },
  { text: "Алло?", minLinks: 4, removeBelow: 2 },
  { text: "Это плохо...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Внезапно оглушающие звуки прервали радиопередачу и построение, которое было видно сквозь иллюминатор прямо перед нами, мгновенно поразил огромный луч энергии.',
        play: ['click', 'radiodeath'],
        stop: [],
        thoughts:[
  { text: "Ушам больно...", minLinks: 4, removeBelow: 2 },
  { text: "Нет...", minLinks: 4, removeBelow: 2 },
  { text: "Не может быть...", minLinks: 4, removeBelow: 2 },
  { text: "Они наверняка... уклонились... я надеюсь...", minLinks: 4, removeBelow: 2 },
  { text: "Пожалуйста...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'По связи раздались слова, перемешивающиеся друг с другом:<br>"Что произошло?"<br>"Первый штурмовик на связи?"<br>"Что случилось с построением?.."',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Что теперь делать...", minLinks: 4, removeBelow: 2 },
  { text: "Обратно лететь?", minLinks: 4, removeBelow: 2 },
  { text: "Драться?", minLinks: 4, removeBelow: 2 },
  { text: "Она опять молчит... наверняка придумала что-то", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я повернула свою голову к RK. Она сидела стиснув зубы и не меняла направление движения, затем говорит:<br><color:rk>"Построение... Не уничтожено..."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Или не придумала...", minLinks: 4, removeBelow: 2 },
  { text: "Она ведь не собирается..?", minLinks: 4, removeBelow: 2 },
  { text: "Какая-же она наивная...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я смотрю на нее с непониманием, пока мы летим в сторону дрейфующих обломков.<br><color:cf>"Да что ты несешь? Построение уничтожили прямо у нас на глазах. Нам... Нам нужно срочно что-то предпринять."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Нам... мы все...", minLinks: 4, removeBelow: 2 },
  { text: "Может управление у нее отобрать?", minLinks: 4, removeBelow: 2 },
  { text: "А как управлять движением...", minLinks: 4, removeBelow: 2 },
  { text: "Она нас погубит!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK со стеклянным взглядом продолжает лететь к обломкам.<br><color:rk>"По протоколу мы должны вернуться в построение... Мы... Сформируем его заново и продолжим операцию..."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Может..? Нет-нет, нам это не поможет точно", minLinks: 4, removeBelow: 2 },
  { text: "Она не хочет верить...", minLinks: 4, removeBelow: 2 },
  { text: "Да что с ней такое?!", minLinks: 4, removeBelow: 2 },
  { text: "И что делать...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:cf>"Это безумие, RK. Нас ждет..."</color><br>Мой взгляд привлекает желтая точка на радаре, очень быстро сближающаяся с нами.<br><color:cf>"Уходи в сторону!"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Какая-же она дура!", minLinks: 4, removeBelow: 2 },
  { text: "На нас заходят!", minLinks: 4, removeBelow: 2 },
  { text: "Угробит нас...", minLinks: 4, removeBelow: 2 },
  { text: "Лучше бы я вела...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Сильный удар о корпус... Моя голова на большой скорости врезается в приборную панель и я слышу хруст... моя голова...',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Больно!", minLinks: 4, removeBelow: 2 },
  { text: "В глазах плывет...", minLinks: 4, removeBelow: 2 },
  { text: "Я проваливаюсь...", minLinks: 4, removeBelow: 2 },
  { text: "Пахнет кровью...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Яркая вспышка света, а затем темнота...',
        play: ['click'],
        stop: ['part3'],
        thoughts:[
  { text: "Пожили и хватит", minLinks: 8, removeBelow: 7 },
  { text: "Хотя бы умерла быстро", minLinks: 8, removeBelow: 7 },
  { text: "Ну полетали и хватит", minLinks: 8, removeBelow: 7 },
  { text: "Жаль я её на место не поставила", minLinks: 8, removeBelow: 7 },
  { text: "Быть пилотом - отстой", minLinks: 8, removeBelow: 7 },
  { text: "Лучше кроликом бы появилась", minLinks: 8, removeBelow: 7 }
]
      },
      {
        text: '...',
        play: ['click'],
        stop: [],
        thoughts:[
  
]
      },
      {
        text: 'Я поворачиваю голову на соседнее кресло. Она выглядит более не способной продолжать бой. И от нашей эскадры ничего не осталось. Построения нет, командир уничтожен. Только шесть наших штурмовиков.',
        play: ['click', 'final'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Нужно предпринять меры", minLinks: 2, removeBelow: 1 },
  { text: "Взять командование на себя", minLinks: 3, removeBelow: 2 },
  { text: "Восстановить строй", minLinks: 4, removeBelow: 3 },
  { text: "Сформировать стратегию", minLinks: 5, removeBelow: 4 },
  { text: "Продержаться", minLinks: 6, removeBelow: 5 },
  { text: "Дать Телхину время", minLinks: 7, removeBelow: 6 },
  { text: "Я справлюсь", minLinks: 8, removeBelow: 7 },
  { text: "Так просто не погибну", minLinks: 9, removeBelow: 8 },
  { text: "Я все сделаю", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: '<color:rk>"Штурмовик 10 берет командование на себя. Всем оставшимся единицам слушать мои приказы."</color>',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Им нужен лидер", minLinks: 2, removeBelow: 1 },
  { text: "Сделаю что смогу", minLinks: 3, removeBelow: 2 },
  { text: "Сфокусируйся...", minLinks: 4, removeBelow: 3 },
  { text: "Ничего не кончено пока я жива", minLinks: 5, removeBelow: 4 },
  { text: "Я исполню свою задачу", minLinks: 6, removeBelow: 5 },
  { text: "Продержусь", minLinks: 7, removeBelow: 6 },
  { text: "Я мыслю, а дроны нет", minLinks: 8, removeBelow: 7 },
  { text: "Нас меньше, но еще кто-то остался", minLinks: 9, removeBelow: 8 },
  { text: "Иначе никак", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: 'Я переключаюсь в режим единоличного управления штурмовиком.',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Си-Эф более не в состоянии продолжать бой", minLinks: 2, removeBelow: 1 },
  { text: "Хоть бы мгновение на то, чтобы проверить что с ней...", minLinks: 3, removeBelow: 2 },
  { text: "Буду вести бой за двоих", minLinks: 4, removeBelow: 3 },
  { text: "Нельзя просто так сложить руки", minLinks: 5, removeBelow: 4 },
  { text: "Дождусь пока она не придет в себя", minLinks: 6, removeBelow: 5 },
  { text: "Ей должно стать лучше...", minLinks: 7, removeBelow: 6 },
  { text: "Хоть бы она была жива...", minLinks: 8, removeBelow: 7 },
  { text: "Я здесь умирать не планирую", minLinks: 9, removeBelow: 8 },
  { text: "И оставлять её тоже не собираюсь", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: '<color:rk>"Десятый и двадцать второй - замыкающее звено. Середина звена - пятый и седьмой. Второй и восьмой - впереди. Нам необходимо выиграть как можно больше времени для Телхина. Звено не разрывать. Мы навяжем им бой на истощение."</color>',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Построить звено", minLinks: 2, removeBelow: 1 },
  { text: "Составить план", minLinks: 3, removeBelow: 2 },
  { text: "Использовать преимущество в скорости", minLinks: 4, removeBelow: 3 },
  { text: "Брать малые группы", minLinks: 5, removeBelow: 4 },
  { text: "Не подставляться", minLinks: 6, removeBelow: 5 },
  { text: "Выйграть время", minLinks: 7, removeBelow: 6 },
  { text: "Должно получится", minLinks: 8, removeBelow: 7 },
  { text: "Будем держаться до последнего", minLinks: 9, removeBelow: 8 },
  { text: "Просто так не сдадимся", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: 'Я набираю скорость и удаляюсь от обломков прошлого построение. На радаре я вижу как оставшиеся штурмовики поступили согласно моему приказу.',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Нет... нет... ", minLinks: 2, removeBelow: 1 },
  { text: "Их правда больше нет", minLinks: 3, removeBelow: 2 },
  { text: "Теперь я за них отвечаю", minLinks: 4, removeBelow: 3 },
  { text: "Отвечаю за Телхин", minLinks: 5, removeBelow: 4 },
  { text: "Отвечаю за неё", minLinks: 6, removeBelow: 5 },
  { text: "Нельзя их подвести", minLinks: 7, removeBelow: 6 },
  { text: "Сфокусируйся", minLinks: 8, removeBelow: 7 },
  { text: "Я справлюсь", minLinks: 9, removeBelow: 8 },
  { text: "Я обязанна справится", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: '<color:rk>"Второй и восьмой - сфокусируйтесь на группе противников отдельных от основного роя. Десятый и двадцать второй будут контролировать тыл. Середина звена - вы будете арьергардом и по необходимости оказывать помощь."</color>',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Построение есть", minLinks: 2, removeBelow: 1 },
  { text: "План есть", minLinks: 3, removeBelow: 2 },
  { text: "Задачи распределены", minLinks: 4, removeBelow: 3 },
  { text: "Теперь нужно быть бдительной", minLinks: 5, removeBelow: 4 },
  { text: "Будем аккуратны", minLinks: 6, removeBelow: 5 },
  { text: "Направление атаки сформированно", minLinks: 7, removeBelow: 6 },
  { text: "Тыл под моей защитой", minLinks: 8, removeBelow: 7 },
  { text: "Будем старатся и бой за нами", minLinks: 9, removeBelow: 8 },
  { text: "Телхин дождется подмоги", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: 'Все вместе мы движемся до малого роя и навязываем им бой.',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Аккуратно", minLinks: 2, removeBelow: 1 },
  { text: "Понемногу", minLinks: 3, removeBelow: 2 },
  { text: "Мимо нас не пройдут", minLinks: 4, removeBelow: 3 },
  { text: "Пока мы стоим, бой за нами", minLinks: 5, removeBelow: 4 },
  { text: "Держимся", minLinks: 6, removeBelow: 5 },
  { text: "Не подставляемся", minLinks: 7, removeBelow: 6 },
  { text: "Действуем умнее", minLinks: 8, removeBelow: 7 },
  { text: "Главное не расслабляться", minLinks: 9, removeBelow: 8 },
  { text: "Мы справимся", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: 'Авангард нашего построения методично отстреливает мелких дронов. Мой штурмовик вместе с двадцать вторым контролирует наш тыл. Всего лишь несколько дронов пытаются атаковать нас. Они не пытаются взять нас с флангов или тыла...',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Прекрасно!", minLinks: 2, removeBelow: 1 },
  { text: "Все идет по плану", minLinks: 3, removeBelow: 2 },
  { text: "Это странно...", minLinks: 4, removeBelow: 3 },
  { text: "Что-то не так?", minLinks: 5, removeBelow: 4 },
  { text: "Нельзя отвлекаться, я в бою", minLinks: 6, removeBelow: 5 },
  { text: "Будем двигаться от того что есть", minLinks: 7, removeBelow: 6 },
  { text: "Пожалуй, стоит отойти обратно", minLinks: 8, removeBelow: 7 },
  { text: "Перегрупируемся и снова вступим в бой", minLinks: 9, removeBelow: 8 },
  { text: "Нужно узнать статус штурмовиков", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: 'Мы продвигаемся вглубь малого роя и я выхожу на связь с построением:<br><color:rk>"Авангард, доложите о статусе своей ситуации."</color>',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Нужно менять построение", minLinks: 2, removeBelow: 1 },
  { text: "Быть непредсказуймыми", minLinks: 3, removeBelow: 2 },
  { text: "Разделиться по двое?", minLinks: 4, removeBelow: 3 },
  { text: "Может заходить линией?", minLinks: 5, removeBelow: 4 },
  { text: "Или взять малые группы в кольцо...", minLinks: 6, removeBelow: 5 },
  { text: "Может у Телхина есть план действий на эту ситуацию?", minLinks: 7, removeBelow: 6 },
  { text: "Нужно выйти с Телхином на связь", minLinks: 8, removeBelow: 7 },
  { text: "Си-Эф все еще не пришла в себя...", minLinks: 9, removeBelow: 8 },
  { text: "Она бы мне очень помогла сейчас", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: '"Восьмой докладывает - нам оказывается минимальное сопротивление"<br>"Второй докладывает - по нам пришлось несколько ударов, но мы пока в строю."',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Это хорошо!", minLinks: 2, removeBelow: 1 },
  { text: "Мы справляемся", minLinks: 3, removeBelow: 2 },
  { text: "Что-то... что-то не так", minLinks: 4, removeBelow: 3 },
  { text: "Прийди уже в себя, прошу...", minLinks: 5, removeBelow: 4 },
  { text: "Хоть бы она была жива...", minLinks: 6, removeBelow: 5 },
  { text: "Без нее сложнее... не знаю даже как это...", minLinks: 7, removeBelow: 6 },
  { text: "Нужно сфокусироваться", minLinks: 8, removeBelow: 7 },
  { text: "Она вернется в сознание", minLinks: 9, removeBelow: 8 },
  { text: "Пора скомандовать им о перегрупировке", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: 'Резко радары начинают сигнализировать о том, что за основной массой роя появились множество значительно более крупных сигнатур. И я замечаю, что в наш тыл стекается массивное красное облако.',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Всего на миг отвлеклась!", minLinks: 2, removeBelow: 1 },
  { text: "Одной гораздо тяжелее...", minLinks: 3, removeBelow: 2 },
  { text: "Нужно уходить", minLinks: 4, removeBelow: 3 },
  { text: "Еще не все потерянно", minLinks: 5, removeBelow: 4 },
  { text: "Перегрупируемся...", minLinks: 6, removeBelow: 5 },
  { text: "Как она там?", minLinks: 7, removeBelow: 6 },
  { text: "Не могу даже посмотреть на секунду на неё...", minLinks: 8, removeBelow: 7 },
  { text: "Нельзя отвлекаться, иначе штурмовик выйдет из контроля", minLinks: 9, removeBelow: 8 },
  { text: "Нужно сохранять контроль", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: 'Даже через иллюминатор я вижу как на фоне едва заметных дронов проявляются фигуры ударных кораблей.',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  
]
      },
      {
        text: '<em>Это была ловушка, нас берут в окружение... Нужно что-то предпринять...</em>',
        play: ['click'],
        stop: [],
        eqMode: true,
        thoughts:[
  { text: "Я не знаю что тут можно сделать...", minLinks: 2, removeBelow: 1 },
  { text: "Слишком поздно...", minLinks: 3, removeBelow: 2 },
  { text: "Я не смогла...", minLinks: 4, removeBelow: 3 },
  { text: "Я подвела их...", minLinks: 5, removeBelow: 4 },
  { text: "Я подвела её...", minLinks: 6, removeBelow: 5 },
  { text: "Я не могу одна это сделать...", minLinks: 7, removeBelow: 6 },
  { text: "Нельзя чтобы все так кончилось...", minLinks: 8, removeBelow: 7 },
  { text: "Что мне делать...", minLinks: 9, removeBelow: 8 },
  { text: "Одной слишком тяжело...", minLinks: 10, removeBelow: 9 }
]
      },
      {
        text: '...',
        play: ['click'],
        stop: [],
        eqMode: false,
        thoughts:[
  
]
      },
      {
        text: 'Я медленно открываю глаза и вижу парящие в невесомости блестящие красные шарики...',
        yellowAnimated: [
          {
            text: "connecting the neural interface",
            dots: true,
            final: "---[UNKNOWN ERROR]---",
            play: [], 
            endPlay: ["fail"] 
          },
          {
            text: "cognitive support activation",
            dots: true,
            final: "---[UNKNOWN ERROR]---",
            play: [],
            endPlay: ["fail"]
          }
        ],
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Это... что? Кровь..?", minLinks: 4, removeBelow: 2 },
  { text: "Голова гудит... ужасно", minLinks: 1, removeBelow: 1 },
  { text: "Меня сейчас вырвет...", minLinks: 6, removeBelow: 4 },
  { text: "Что... что со мной?", minLinks: 6, removeBelow: 4 },
  { text: "Хотя бы... жива..?", minLinks: 8, removeBelow: 6 },
  { text: "Я... умираю?", minLinks: 4, removeBelow: 2 },
  { text: "Мне очень страшно...", minLinks: 2, removeBelow: 1 }
]
      },
      {
        text: 'Я дотягиваюсь до своей головы и трогаю ее. Теплая полусвернувшаясья кровь липнет к моим пальцам.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Нет... опять моя кровь?", minLinks: 4, removeBelow: 2 },
  { text: "Как же тошно...", minLinks: 1, removeBelow: 1 },
  { text: "Не вижу ничего...", minLinks: 3, removeBelow: 1 },
  { text: "В ушах звенит", minLinks: 6, removeBelow: 4 }
]
      },
      {
        text: '<em>Я что... умираю?...</em>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Нет...", minLinks: 4, removeBelow: 2 },
  { text: "Я не хочу...", minLinks: 4, removeBelow: 2 },
  { text: "Страшно!", minLinks: 4, removeBelow: 2 },
  { text: "Только не это... нет!", minLinks: 4, removeBelow: 2 },
  { text: "Где... где я?", minLinks: 4, removeBelow: 2 },
  { text: "И почему...", minLinks: 4, removeBelow: 2 },
  { text: "Что..?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Странное и всеобъемливающее чувство страха... Я впервые чувствую страх.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Я умру..?", minLinks: 1, removeBelow: 1 },
  { text: "Умру!", minLinks: 1, removeBelow: 1 },
  { text: "Это конец!", minLinks: 1, removeBelow: 1 },
  { text: "Все...", minLinks: 1, removeBelow: 1 },
  { text: "За что же все мне это...", minLinks: 1, removeBelow: 1 },
  { text: "Я не хочу...", minLinks: 1, removeBelow: 1 },
  { text: "Не хочу так... не хочу...", minLinks: 1, removeBelow: 1 },
  { text: "Я хочу жить...", minLinks: 1, removeBelow: 1 },
  { text: "Просто... и все...", minLinks: 1, removeBelow: 1 },
  { text: "Не справедливо...", minLinks: 1, removeBelow: 1 }
]
      },
      {
        text: 'Сквозь мутную пелену я вижу RK. Она пытается докричаться до меня, но в ушах я слышу лишь звон.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "А?", minLinks: 4, removeBelow: 2 },
  { text: "Снова тошнит...", minLinks: 4, removeBelow: 2 },
  { text: "Я тут умираю, а она от меня что-то хочет...", minLinks: 4, removeBelow: 2 },
  { text: "Может спрашивает живая ли я вообще?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:rk>"CF, На***я на ***у Телхина нем****о"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "... нахуя..?", minLinks: 8, removeBelow: 6 },
  { text: "Да я уже неделю как Си-Эф!", minLinks: 2, removeBelow: 1 },
  { text: "На..?", minLinks: 4, removeBelow: 2 },
  { text: "У-у-у-у... болит все...", minLinks: 4, removeBelow: 2 },
  { text: "Ну Телхин я знаю!", minLinks: 2, removeBelow: 1 },
  { text: "Немо... нем... о-о-о... а?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я держусь за голову и по моим щекам начинают стекать слезы.<br><color:cf>"Неужели все кто был в построении - погибли?... Мы погибнем... Мы умрем, я не хочу умирать, я хочу жить!"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Не могу я так...", minLinks: 4, removeBelow: 2 },
  { text: "Это все...", minLinks: 4, removeBelow: 2 },
  { text: "Почему я?", minLinks: 4, removeBelow: 2 },
  { text: "И зачем мне... это...", minLinks: 4, removeBelow: 2 },
  { text: "Просто умру в этой коробке...", minLinks: 4, removeBelow: 2 },
  { text: "Вот так просто... и все...", minLinks: 4, removeBelow: 2 },
  { text: "Не справедливо...", minLinks: 4, removeBelow: 2 },
  { text: "Просто хочу убежать... убежать... убежать... некуда...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я смотрю на радар и вижу, как нас облепливают дроны. Стуки об обшивку доносятся сквозь оглушительный звон.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Почему умирать так страшно..?", minLinks: 4, removeBelow: 2 },
  { text: "Это просто пытка...", minLinks: 4, removeBelow: 2 },
  { text: "Кошмар...", minLinks: 4, removeBelow: 2 },
  { text: "Ужас!", minLinks: 4, removeBelow: 2 },
  { text: "Я всего этого не заслужила!", minLinks: 4, removeBelow: 2 },
  { text: "Что я вообще сделала...", minLinks: 4, removeBelow: 2 },
  { text: "Я ничего совсем в своей жизни не сделала...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Внезапно все приборы прекращают функционировать и гаснут, но через несколько секунд кабину заполняет красный свет аварийного освещения. Шум в ушах постепенно стихает.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Это... просто не заканчивается...", minLinks: 4, removeBelow: 2 },
  { text: "Стены давят... как же тут узко!", minLinks: 4, removeBelow: 2 },
  { text: "Некуда сбежать...", minLinks: 4, removeBelow: 2 },
  { text: "Никто не поможет...", minLinks: 4, removeBelow: 2 },
  { text: "Умрем...", minLinks: 4, removeBelow: 2 },
  { text: "Умрем долго...", minLinks: 4, removeBelow: 2 },
  { text: "Умрем мучительно...", minLinks: 4, removeBelow: 2 },
  { text: "Умрем одни...", minLinks: 4, removeBelow: 2 },
  { text: "Умрем ни за что...", minLinks: 4, removeBelow: 2 },
  { text: "Умрем страшной смертью...", minLinks: 4, removeBelow: 2 },
  { text: "Умрем на смерть... как глупо... глупо умрем...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK отстегивается от кресла и ловко ныряет под мое сидение, протягивая мне мою слетевшую гарнитуру.<br><color:rk>"Настройся на частоту Телхина немедленно. Я буду поддерживать работу реле через аварийное питание сколько смогу."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "А-а-а? Слышу...", minLinks: 4, removeBelow: 2 },
  { text: "Я еще не оглохла...", minLinks: 4, removeBelow: 2 },
  { text: "Как же долго я умираю...", minLinks: 4, removeBelow: 2 },
  { text: "Хорошо что хоть она со мной...", minLinks: 4, removeBelow: 2 },
  { text: "Плохо что она со мной...", minLinks: 4, removeBelow: 2 },
  { text: "Она этого не заслужила...", minLinks: 4, removeBelow: 2 },
  { text: "Какая-же она... мне... её ужасно жаль...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я словно в бреду беру трясущейся рукой гарнитуру и надеваю ее на голову... Больно...',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Может я и не умираю..?", minLinks: 4, removeBelow: 2 },
  { text: "Руки ватные совсем... не слушаются...", minLinks: 4, removeBelow: 2 },
  { text: "Хочется заплакать... не хочу я Телхин вызывать...", minLinks: 4, removeBelow: 2 },
  { text: "Хочется обратно вернуться...", minLinks: 4, removeBelow: 2 },
  { text: "Может к черту все это?", minLinks: 4, removeBelow: 2 },
  { text: "Пахнет здесь ужасно...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Сквозь иллюминатор я могу разглядеть силуэт Телхина.<br><em>Нужно связаться с ним...</em>',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Телхин", minLinks: 1, removeBelow: 1, interactive: true },
  { text: "Спасите...", minLinks: 4, removeBelow: 2 },
  { text: "Хватит с нас!", minLinks: 4, removeBelow: 2 },
  { text: "Мы все что могли сделали!", minLinks: 4, removeBelow: 2 },
  { text: "Не заслужи мы этого!", minLinks: 4, removeBelow: 2 },
  { text: "За что они так с нами?", minLinks: 4, removeBelow: 2 },
  { text: "Они ведь просто избавились от нас...", minLinks: 4, removeBelow: 2 },
  { text: "Мы ведь живые, между прочим... и за что так с нами?", minLinks: 4, removeBelow: 2 },
  { text: "Все в пустую... столько жизней...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:cf>"П-прием... Телхин?"</color>',
        play: ['click', 'radiotelkhin'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Телхин", minLinks: 1, removeBelow: 1, interactive: true },
  { text: "Тишина...", minLinks: 4, removeBelow: 2 },
  { text: "Боятся ответить?", minLinks: 4, removeBelow: 2 },
  { text: "Надеюсь им стыдно!", minLinks: 4, removeBelow: 2 },
  { text: "Им должно быть стыдно!", minLinks: 4, removeBelow: 2 },
  { text: "Все это не справедливо!", minLinks: 4, removeBelow: 2 },
  { text: "Почему мы здесь, а они там?", minLinks: 4, removeBelow: 2 },
  { text: "Это ведь их бой! Не наш!", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Стуки по обшивке становятся более гулкими.<br><color:cf>"Телхин!... Меня слышно?"</color>',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Телхин", minLinks: 1, removeBelow: 1, interactive: true },
  { text: "Это не заканчивается...", minLinks: 4, removeBelow: 2 },
  { text: "Ужасная пытка...", minLinks: 4, removeBelow: 2 },
  { text: "Я уже хочу умереть наконец...", minLinks: 4, removeBelow: 2 },
  { text: "Просто ужасно... плохо... тошно... ", minLinks: 4, removeBelow: 2 },
  { text: "Я не могу так... не могу... нет...", minLinks: 4, removeBelow: 2 },
  { text: "Хватит...", minLinks: 0, removeBelow: 0 },
  { text: "Не могу больше...", minLinks: 0, removeBelow: 0 }
]
      },
      {
        text: '<color:cf>"Кто-нибудь прием... Пожалуйста..."</color><br>Я больше не могу сдерживаться и начинаю реветь.',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Телхин", minLinks: 1, removeBelow: 1, interactive: true },
  { text: "Все бестолку...", minLinks: 4, removeBelow: 2 },
  { text: "Бестолковый Телхин...", minLinks: 4, removeBelow: 2 },
  { text: "Бес-Телхин...", minLinks: 4, removeBelow: 2 },
  { text: "Просто все... нет сил...", minLinks: 4, removeBelow: 2 },
  { text: "Хуже просто быть не может...", minLinks: 4, removeBelow: 2 },
  { text: "Никакого смысла нет в этом...", minLinks: 4, removeBelow: 2 },
  { text: "Нет смысла в борьбе...", minLinks: 4, removeBelow: 2 },
  { text: "В нас нет смысла...", minLinks: 4, removeBelow: 2 },
  { text: "В нашей смерти нет смысла...", minLinks: 4, removeBelow: 2 },
  { text: "В этой войне нет смысла...", minLinks: 4, removeBelow: 2 },
  { text: "Все напрасно...", minLinks: 4, removeBelow: 2 },
  { text: "Страдания ради страданий...", minLinks: 4, removeBelow: 2 },
  { text: "Ненавижу их...", minLinks: 0, removeBelow: 0 }
]
      },
      {
        text: '...',
        play: ['click'],
        stop: [],
        clickblock: true,
        thoughts: [
  { text: "Телхин...", minLinks: 1, removeBelow: 1, interactive: true }
]
      },
      {
        text: '<em>Что это...</em>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Это конец...", minLinks: 4, removeBelow: 2 },
  { text: "Это наша смерть...", minLinks: 4, removeBelow: 2 },
  { text: "Все...", minLinks: 4, removeBelow: 2 },
  { text: "Это конец всему...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'От вражеских кораблей исходит множество острых лучей света, но кажется они проходят по касательной, повреждая наше реле и связь обрывается. Лучи продолжают свой путь в сторону Телхина и пройдя сквозь него, разрезают его на множество частей.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Это им кара...", minLinks: 4, removeBelow: 2 },
  { text: "За все...", minLinks: 4, removeBelow: 2 },
  { text: "Их нет...", minLinks: 4, removeBelow: 2 },
  { text: "Это не справедливо... все равно... мне их жаль... ужасно жаль...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Я медленно стягиваю гарнитуру с головы, не веря своим глазам. Начинает тошнить...',
        play: ['click'],
        stop: ['radiotelkhin'],
        thoughts:[
  { text: "Дышать нечем...", minLinks: 4, removeBelow: 2 },
  { text: "Не могу больше плакать...", minLinks: 4, removeBelow: 2 },
  { text: "Не могу больше так жить...", minLinks: 4, removeBelow: 2 },
  { text: "Это вечный кошмар...", minLinks: 4, removeBelow: 2 },
  { text: "Сколько я уже здесь..?", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:cf>"Они все мертвы?..."</color><br>Я отстегиваюсь от кресла и пытаюсь встать, но я лишь начинаю парить в невесомости.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "А может я уже умерла?", minLinks: 4, removeBelow: 2 },
  { text: "Нет... вдруг я правда... в каком-то посмертье?", minLinks: 4, removeBelow: 2 },
  { text: "Ад для бестолковых репликантов...", minLinks: 4, removeBelow: 2 },
  { text: "Коробка смерти... даже стоять нельзя...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK пытается усадить меня обратно в кресло, но я отталкиваю ее.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Да пошла ты...", minLinks: 4, removeBelow: 2 },
  { text: "Добей меня просто...", minLinks: 4, removeBelow: 2 },
  { text: "Всезнайка!", minLinks: 4, removeBelow: 2 },
  { text: "Деловитая!", minLinks: 4, removeBelow: 2 },
  { text: "Дура!", minLinks: 4, removeBelow: 2 },
  { text: "Умница!", minLinks: 4, removeBelow: 2 },
  { text: "Красавица!", minLinks: 4, removeBelow: 2 },
  { text: "Командирша!", minLinks: 4, removeBelow: 2 },
  { text: "Сучка...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Слезы скапливаются на моем лице.<br><color:cf>"Почему все так... Почему-у-у..."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Вот бы не думать вообще...", minLinks: 1, removeBelow: 1 },
  { text: "Надоело...", minLinks: 1, removeBelow: 1 },
  { text: "Думай не думай, а все одно...", minLinks: 1, removeBelow: 1 },
  { text: "Ничего не вышло...", minLinks: 1, removeBelow: 1 }
]
      },
      {
        text: 'RK резко хватает меня за руку и подтягивает к себе. Ее лицо оказывается прямо перед моим. Ее прежде спокойного и холодного выражения лица больше не видно. На ее лице скорее растерянность с отчаянием.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Ей тоже плохо...", minLinks: 4, removeBelow: 2 },
  { text: "И она не плачет... как..?", minLinks: 4, removeBelow: 2 },
  { text: "Как же мне её жаль...", minLinks: 4, removeBelow: 2 },
  { text: "Бедняжка...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'Она молчит, а я просто смотрю ей в глаза, чувствуя лишь пустоту.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Глаза у нее выразительные...", minLinks: 4, removeBelow: 2 },
  { text: "Может поэтому и не плачет?", minLinks: 4, removeBelow: 2 },
  { text: "За тени боится..?", minLinks: 4, removeBelow: 2 },
  { text: "Целый день подводила их...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:cf>"Мы не должны были здесь оказаться..."</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Хотелось бы чтобы все было иначе...", minLinks: 4, removeBelow: 2 },
  { text: "Как угодно, но не так...", minLinks: 4, removeBelow: 2 },
  { text: "Без всего этого...", minLinks: 4, removeBelow: 2 },
  { text: "Я заслужила лучшего!", minLinks: 4, removeBelow: 2 },
  { text: "Она заслуживает еще большего...", minLinks: 4, removeBelow: 2 },
  { text: "Мне... надо её поблагодарить что была рядом...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK кивает, говоря полушепотом:<br><color:rk>"Мы больше ничего не сможем сделать. Нужно позаботиться о тебе."</color><br>Она аккуратно осматривает мою рану на голове. Каждое прикосновение отзывается острой болью.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Больно! Все еще больно...", minLinks: 4, removeBelow: 2 },
  { text: "Боль-боль-боль... сплошная боль!", minLinks: 4, removeBelow: 2 },
  { text: "Дура... переживает за меня", minLinks: 4, removeBelow: 2 },
  { text: "Поблагодарить её нужно", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:rk>"Я помогу тебе забраться в криокапсулу."</color><br>Она оттолкнулась от кресла и держа меня за руку переместилась к одной из двух капсул. Удары по обшивке стихли. Кажется у дронов пропал к нам интерес.',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Да они даже добивать нас не хотят...", minLinks: 4, removeBelow: 2 },
  { text: "Какие же мы жалкие...", minLinks: 4, removeBelow: 2 },
  { text: "Ничего даже не сделали...", minLinks: 4, removeBelow: 2 },
  { text: "В пустую все...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: 'RK открыла капсулу и начала располагать меня в ней.<br>В этот момент я беру ее за руку.<br><color:cf>"А как же ты?"</color>',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Еще одна коробка... еще меньше чем эта...", minLinks: 4, removeBelow: 2 },
  { text: "Не хочу я в коробку...", minLinks: 4, removeBelow: 2 },
  { text: "Это единственный путь отсюда...", minLinks: 4, removeBelow: 2 },
  { text: "Билет вникуда...", minLinks: 4, removeBelow: 2 },
  { text: "Выглядит как гроб...", minLinks: 4, removeBelow: 2 },
  { text: "Как-то жарко стало...", minLinks: 4, removeBelow: 2 }
]
      },
      {
        text: '<color:rk>"После тебя."</color><br>Она отводит мою руку от своей и закрывает крышку. Сквозь мутное стекло я вижу, как ее силуэт движется в сторону второй капсулы. Кажется я теряю сознание...',
        play: ['click'],
        stop: [],
        thoughts:[
  { text: "Холодно... опять...", minLinks: 4, removeBelow: 2 },
  { text: "Пожалуйста, выживи...", minLinks: 4, removeBelow: 2 },
  { text: "Все кончилось...", minLinks: 4, removeBelow: 2 },
  { text: "Наконец-то... отдых...", minLinks: 4, removeBelow: 2 },
  { text: "Все...", minLinks: 4, removeBelow: 2 }
]
      },
    ];

    let currentSlide = -1;
    let readyForClick = false;
    let yellowAnimationActive = false;

  const colorVars = {
  alice: "#30d5c8",
  rk: "#F5BA0A",
  instructor: "#ff6666",
  cf: "#3ecfff"
};

  function renderAnnotatedText(text) {
    if (!text) return '';
    text = text.replace(/\[\[([^\|\]]+)\|([^\]]+)\]\]/g, (m, word, info) => {
      return `<span class="yellow-annot">${word}<span class="yellow-annot-tooltip">${info}</span></span>`;
    });
    text = text.replace(/<color:([a-zA-Z0-9_]+)>(.*?)<\/color>/g, (m, varName, inner) => {
      const color = colorVars[varName] || "#fff";
      return `<span style="color: ${color};">${inner}</span>`;
    });
    return text;
  }


    function createSlide(slide) {
      const div = document.createElement('div');
      div.classList.add('slide');
      if (slide.text) {
        const textDiv = document.createElement('div');
        textDiv.innerHTML = renderAnnotatedText(slide.text);
        div.appendChild(textDiv);
      }
      if (slide.yellowAnimated) {
        div._yellowAnimated = Array.isArray(slide.yellowAnimated)
          ? slide.yellowAnimated.map(obj => ({ ...obj }))
          : [{ ...slide.yellowAnimated }];
      }
      container.appendChild(div);
      return div;
    }

    function showNextSlide() {
      if (currentSlide >= 0) {
        slidesElements[currentSlide].classList.remove('active');
        slidesElements[currentSlide].classList.add('out');
      }

      currentSlide++;

      if (currentSlide >= slides.length) return;

      interactiveThoughtWasAlive = false;
      const slide = slides[currentSlide];
      const { play, stop, filterOn = [], filterOff = [], clickblock = false } = slide;
      const eqSourceId = slide.eqSource || 'final';
      if (slide.eqMode) {
        try {
          if (!analyser) {
            analyser = audioCtx.createAnalyser();
            analyser.fftSize = 64;
            dataArray = new Uint8Array(analyser.frequencyBinCount);
          }

          const anyFilter = filters[eqSourceId];
          if (anyFilter && !anyFilter._eqLinked) {
            anyFilter.connect(analyser);
            analyser.connect(audioCtx.destination);
            anyFilter._eqLinked = true;
          }

          isMarsEQ = true;
          drawLinks = drawLinksMars;
          console.log("EQ-режим активен (через существующий фильтр)");
        } catch (err) {
          console.warn("EQ activation error:", err);
        }
      } else {
      isMarsEQ = false;
      drawLinks = window.drawLinksOriginal || drawLinks;

      try {
        const anyFilter = filters[eqSourceId] || Object.values(filters)[0];
        if (anyFilter && anyFilter._eqLinked && analyser) {
          try { anyFilter.disconnect(analyser); } catch(e) {}
          anyFilter._eqLinked = false;
        }
        if (analyser) {
          try { analyser.disconnect(); } catch(e) {}
        }
        analyser = null;
        dataArray = null;
      } catch (err) { console.warn(err); }

      particles.forEach(p => { p.eqAlphaTarget = 1; });
      links.forEach(l => { l.eqAlphaTarget = 1; });
    }



      stop?.forEach(id => {
        const audio = audioMap[id];
        if (audio) {
          audio.pause();
          try {
            audio.currentTime = 0;
            if (audio.loop) {
              audio.loop = false;
              setTimeout(() => { audio.loop = true; }, 100);
            }
          } catch (e) {}
        }
      });

      play?.forEach(id => {
        const audio = audioMap[id];
        if (audio) {
          audio.volume = audioVolumes[id] !== undefined ? audioVolumes[id] : 0.5;
          audio.play().catch(e => console.warn("Autoplay blocked", e));
        }
      });

      filterOn?.forEach(id => {
        const filter = filters[id];
        if (filter) filter.frequency.value = 2000;
      });

      filterOff?.forEach(id => {
        const filter = filters[id];
        if (filter) filter.frequency.value = 22000;
      });

      blockAdvanceByClickblock = !!clickblock;

      const el = slidesElements[currentSlide];
      el.classList.add('active');
      resetParticleHomes();


      const yellowGlobal = document.getElementById('yellowAnimatedGlobal');
      yellowGlobal.style.display = 'none';
      yellowAnimationActive = false;

      if (el._yellowAnimated && el._yellowAnimated.length > 0) {
        yellowAnimationActive = true;
        animateYellowTextSequence(el._yellowAnimated, () => {
          yellowAnimationActive = false;
        });
      } else {
        yellowGlobal.style.display = 'none';
      }

      if (slide.thoughts && slide.thoughts.some(t => t.interactive)) {
        blockAdvanceByInteractive = true;
      } else {
        blockAdvanceByInteractive = false;
      }
    }

    function triggerNegativeEffect() {
      document.body.classList.add('negative-effect-animate');
      setTimeout(() => {
        document.body.classList.remove('negative-effect-animate');
        document.body.classList.add('negative-effect');
      }, 500);
    }

    function animateYellowTextSequence(sequence, onFinish) {
      const yellowGlobal = document.getElementById('yellowAnimatedGlobal');
      let idx = 0;
      function next() {
        if (idx >= sequence.length) {
          yellowGlobal.style.display = 'none';
          if (typeof onFinish === 'function') onFinish();
          return;
        }
        yellowGlobal.style.display = '';
        animateYellowTextGlobal(sequence[idx], () => {
          idx++;
          next();
        });
      }
      next();
    }

    function animateYellowTextGlobal({ text, dots, final, play = [], endPlay = [] }, onFinish) {
      const yellowGlobal = document.getElementById('yellowAnimatedGlobal');
      let dotCount = 0;
      let maxDots = 3;
      let interval;
      yellowGlobal.style.display = '';
      yellowGlobal.textContent = text + (dots ? '.' : '');

      play.forEach(id => {
        const audio = audioMap[id];
        if (audio) {
          audio.volume = audioVolumes[id] !== undefined ? audioVolumes[id] : 0.5;
          audio.play().catch(e => {});
        }
      });

      if (dots) {
        interval = setInterval(() => {
          dotCount = (dotCount + 1) % (maxDots + 1);
          yellowGlobal.textContent = text + '.'.repeat(dotCount);
        }, 400);
      }
      setTimeout(() => {
        if (interval) clearInterval(interval);
        yellowGlobal.textContent = final;

        endPlay.forEach(id => {
          const audio = audioMap[id];
          if (audio) {
            audio.volume = audioVolumes[id] !== undefined ? audioVolumes[id] : 0.5;
            audio.play().catch(e => {});
          }
        });

        setTimeout(() => {
          if (typeof onFinish === 'function') onFinish();
        }, 700);
      }, 3000);
    }

    const slidesElements = slides.map(slide => createSlide(slide));

      startBtn.addEventListener('click', async () => {
      await audioCtx.resume().catch(e => console.warn("AudioContext resume error:", e));
      startBtn.style.display = 'none';
      showNextSlide();
      setTimeout(() => {
        readyForClick = true;
      }, 100);
    });

    container.addEventListener('click', () => {
      if (!readyForClick) return;
      if (yellowAnimationActive) return;
      if (blockAdvanceUntilCF377Ends) return;
      if (blockAdvanceUntilInteractiveCleared) return;
      if (blockAdvanceByClickblock) return;
      if (currentSlide >= 0 && currentSlide < slides.length - 1) {
        showNextSlide();
      }
    });

    const audioVolumes = {
      ambience1: 0.5,
      music1: 0.2,
      ambience2: 0.5,
      ambience3: 0.5,
      open1: 0.5,
      open2: 0.5,
      open3: 0.5,
      open4: 0.5,
      surgery: 1,
      access: 0.1,
      CF377: 1
    };

    const style = document.createElement('style');
    style.textContent = `
      body.negative-effect {
        filter: invert(1) hue-rotate(180deg) contrast(1.2) brightness(1.1);
        background: #fff !important;
        color: #000 !important;
        transition: filter 0.5s cubic-bezier(.4,2,.6,1), background 0.5s, color 0.5s;
      }
      body.negative-effect-animate {
        animation: negative-flash 0.5s cubic-bezier(.4,2,.6,1);
      }
      @keyframes negative-flash {
        0% { filter: none; background: #000; color: #ccc; }
        100% { filter: invert(1) hue-rotate(180deg) contrast(1.2) brightness(1.1); background: #fff; color: #000;}
      }
    `;
    document.head.appendChild(style);

      const cursor = document.getElementById('customCursor');

  document.addEventListener('mousemove', (e) => {
    cursor.style.left = e.clientX + 'px';
    cursor.style.top = e.clientY + 'px';
  });

  document.addEventListener('mouseover', (e) => {
    if (e.target.closest('button, a, .clickable')) {
      document.body.classList.add('pointer-hover');
    }
  });

  document.addEventListener('mouseout', (e) => {
    if (e.target.closest('button, a, .clickable')) {
      document.body.classList.remove('pointer-hover');
    }
  });
  </script>
  <script>
  const canvas = document.getElementById("particleCanvas");
  const ctx = canvas.getContext("2d");
  let particles = [];
  const particleCount = 100;
  let mouse = { x: null, y: null };

  const LINK_DISTANCE = 60;
  const LINK_BREAK_DISTANCE = 120;
  const LINK_TIME = 1000;
  const LINK_FORCE = 0.0010;

  let links = [];
  let linkMap = new Map();

  function pairKey(a, b) {
    return a.id < b.id ? `${a.id}|${b.id}` : `${b.id}|${a.id}`;
  }

  const LINK_UPDATE_PERIOD = 2;
  const CLUSTER_UPDATE_PERIOD = 6;
  let frameCount = 0;
  let activeRects = [];
  let breakingLinks = [];
  if (linkMap && linkMap.clear) linkMap.clear();

  let activeThoughts = [];
  let thoughtTemplates = [];
  const CLUSTER_RADIUS = 48;
  const CLUSTER_MATCH_RADIUS = 50;
  let nextThoughtId = 1;

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    particles.forEach(p => {
      p.homeX = Math.random() * canvas.width;
      p.homeY = Math.random() * canvas.height;
      if (p.x > canvas.width) p.x = p.homeX;
      if (p.y > canvas.height) p.y = p.homeY;
    });
  }

  resizeCanvas();
  window.addEventListener("resize", resizeCanvas);

  document.addEventListener("mousemove", e => {
    mouse.x = e.clientX;
    mouse.y = e.clientY;
  });

  class Particle {
    constructor() {
      this.homeX = Math.random() * canvas.width;
      this.homeY = Math.random() * canvas.height;
      this.x = this.homeX;
      this.y = this.homeY;
      this.vx = (Math.random() - 0.2) * 0.2;
      this.vy = (Math.random() - 0.2) * 0.2;
      this.size = Math.random() * 2 + 1;
      this.baseAlpha = Math.random() * 0.4 + 0.4;
      this.alphaOffset = Math.random() * Math.PI * 2;
      this.wanderAngle = Math.random() * Math.PI * 2;
      this.id = Particle._id++;
      this.nearTimes = {};
    }

    update(time) {
      let dxHome = this.homeX - this.x;
      let dyHome = this.homeY - this.y;
      this.vx += dxHome * 0.0003;
      this.vy += dyHome * 0.0003;

      this.wanderAngle += (Math.random() - 0.5) * 0.05;
      this.vx += Math.cos(this.wanderAngle) * 0.02;
      this.vy += Math.sin(this.wanderAngle) * 0.02;

      let dx = this.x - mouse.x;
      let dy = this.y - mouse.y;
      let dist = Math.sqrt(dx * dx + dy * dy);
      if (dist < 100) {
        this.vx += dx / dist * 0.08;
        this.vy += dy / dist * 0.08;
      }

      for (const link of links) {
        let other = null;
        if (link.a === this) other = link.b;
        else if (link.b === this) other = link.a;
        if (other) {
          let dxl = other.x - this.x;
          let dyl = other.y - this.y;
          let d = Math.sqrt(dxl * dxl + dyl * dyl) || 1;
          this.vx += dxl / d * LINK_FORCE;
          this.vy += dyl / d * LINK_FORCE;
        }
      }

      this.x += this.vx;
      this.y += this.vy;

      this.vx *= 0.94;
      this.vy *= 0.94;

      this.alpha = this.baseAlpha + Math.sin(time / 1000 + this.alphaOffset) * 0.2;
    }

    getOpacity() {
  let opacity = this.alpha;
  if (!activeRects || activeRects.length === 0) return Math.max(0, Math.min(1, opacity));
  for (const rect of activeRects) {
    const cx = this.x, cy = this.y;
    const dx = Math.max(rect.left - cx, 0, cx - rect.right);
    const dy = Math.max(rect.top - cy, 0, cy - rect.bottom);
    const dist = Math.sqrt(dx*dx + dy*dy);
    if (dist < 120) {
      opacity *= dist / 120;
    }
  }
  return Math.max(0, Math.min(1, opacity));
}

    draw() {
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
      const alpha = this.getOpacity() * (this.eqAlpha !== undefined ? this.eqAlpha : 1);
      ctx.fillStyle = `rgba(255,255,255,${alpha})`;
      ctx.fill();
      
    }
  }

  Particle._id = 0;

  for (let i = 0; i < particleCount; i++) {
    particles.push(new Particle());
  }

  function updateLinks(time) {
    const LINK_DIST2 = LINK_DISTANCE * LINK_DISTANCE;
    const LINK_BREAK2 = LINK_BREAK_DISTANCE * LINK_BREAK_DISTANCE;

    for (let i = 0; i < particles.length; i++) {
      const a = particles[i];
      for (let j = i + 1; j < particles.length; j++) {
        const b = particles[j];
        const dx = a.x - b.x, dy = a.y - b.y;
        const dist2 = dx * dx + dy * dy;
        const key = pairKey(a, b);
        const existing = linkMap.get(key);

        if (dist2 < LINK_DIST2) {
          if (!a.nearTimes[b.id]) a.nearTimes[b.id] = time;
          if (!b.nearTimes[a.id]) b.nearTimes[a.id] = time;
          const nearTime = Math.max(a.nearTimes[b.id], b.nearTimes[a.id]);
          if (!existing && (time - nearTime > LINK_TIME)) {
            linkMap.set(key, { a, b, created: time, progress: 0, eqAlpha: 1 });
          }
        } else {
          a.nearTimes[b.id] = time;
          b.nearTimes[a.id] = time;
        }

        const link = linkMap.get(key);
        if (link && dist2 > LINK_BREAK2) {
          linkMap.delete(key);
          breakingLinks.push({ ...link, progress: link.progress || 1 });
        }
      }
    }

    for (const [k, l] of linkMap.entries()) {
      if (!particles.includes(l.a) || !particles.includes(l.b)) linkMap.delete(k);
    }
  }

  function drawLinks() {
    ctx.save();
    ctx.lineWidth = 1.1;

    for (const link of linkMap.values()) {
      if (link.progress < 1) link.progress += 0.08;
      if (link.progress > 1) link.progress = 1;

      const { a, b, progress } = link;
      const eqAlpha = (link.eqAlpha === undefined) ? 1 : link.eqAlpha;

      const x1 = a.x, y1 = a.y;
      const x2 = a.x + (b.x - a.x) * progress;
      const y2 = a.y + (b.y - a.y) * progress;

      const alpha = 0.18 * eqAlpha;
      if (alpha > 0.003) {
        ctx.strokeStyle = `rgba(255,255,255,${alpha})`;
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.stroke();
      }
    }

    for (let i = breakingLinks.length - 1; i >= 0; i--) {
      const link = breakingLinks[i];
      link.progress -= 0.08;
      if (link.progress <= 0) {
        breakingLinks.splice(i, 1);
        continue;
      }
      const { a, b, progress } = link;
      const eqAlpha = (link.eqAlpha === undefined) ? 1 : link.eqAlpha;
      const x1 = a.x, y1 = a.y;
      const x2 = a.x + (b.x - a.x) * progress;
      const y2 = a.y + (b.y - a.y) * progress;

      const alpha = 0.18 * eqAlpha;
      if (alpha > 0.003) {
        ctx.strokeStyle = `rgba(255,255,255,${alpha})`;
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.stroke();
      }
    }

    ctx.restore();
  }

function drawLinksMars() {
  ctx.save();
  ctx.lineWidth = 1.1;
  for (const link of links) {
    if (link.progress < 1) link.progress += 0.08;
    if (link.progress > 1) link.progress = 1;
    const { a, b, progress, eqAlpha = 1 } = link;
    const x1 = a.x, y1 = a.y;
    const x2 = a.x + (b.x - a.x) * progress;
    const y2 = a.y + (b.y - a.y) * progress;
    const alpha = 0.18 * eqAlpha;
    ctx.strokeStyle = `rgba(255,255,255,${alpha})`;
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.stroke();
  }
  for (let i = breakingLinks.length - 1; i >= 0; i--) {
    const link = breakingLinks[i];
    link.progress -= 0.08;
    if (link.progress <= 0) {
      breakingLinks.splice(i, 1);
      continue;
    }
    const { a, b, progress, eqAlpha = 1 } = link;
    const x1 = a.x, y1 = a.y;
    const x2 = a.x + (b.x - a.x) * progress;
    const y2 = a.y + (b.y - a.y) * progress;
    const alpha = 0.18 * eqAlpha;
    ctx.strokeStyle = `rgba(255,255,255,${alpha})`;
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.stroke();
  }
  ctx.restore();
}


if (!window.drawLinksOriginal) window.drawLinksOriginal = drawLinks;


    function computeClustersFromLinks() {
    const clusters = [];
    const linkArr = Array.from(linkMap.values());

    for (let i = 0; i < linkArr.length; i++) {
      const l = linkArr[i];
      const mx = (l.a.x + l.b.x) / 2;
      const my = (l.a.y + l.b.y) / 2;
      let placed = false;
      for (const c of clusters) {
        const dx = c.x - mx, dy = c.y - my;
        if (dx*dx + dy*dy < CLUSTER_RADIUS * CLUSTER_RADIUS) {
          c.x = (c.x * c.count + mx) / (c.count + 1);
          c.y = (c.y * c.count + my) / (c.count + 1);
          c.count++;
          c.links.push(l);
          placed = true;
          break;
        }
      }
      if (!placed) {
        clusters.push({ x: mx, y: my, count: 1, links: [l] });
      }
    }

    const now = performance.now();
    const newPrev = [];
    const prevPool = previousClusterRecords.slice();

    for (const c of clusters) {
      let matched = null;
      let matchedIndex = -1;
      for (let i = 0; i < prevPool.length; i++) {
        const p = prevPool[i];
        const d2 = (p.x - c.x)*(p.x - c.x) + (p.y - c.y)*(p.y - c.y);
        if (d2 < CLUSTER_MATCH_ID_RADIUS * CLUSTER_MATCH_ID_RADIUS) {
          matched = p;
          matchedIndex = i;
          break;
        }
      }
      if (matched) {
        c.uid = matched.uid;
        newPrev.push({ uid: matched.uid, x: c.x, y: c.y, lastSeen: now });
        prevPool.splice(matchedIndex, 1);
      } else {
        c.uid = 'c' + (nextClusterUid++);
        newPrev.push({ uid: c.uid, x: c.x, y: c.y, lastSeen: now });
      }
    }

    previousClusterRecords = newPrev;
    return clusters;
  }


  let previousClusterRecords = [];
  let nextClusterUid = 1;
  let blockAdvanceUntilInteractiveCleared = false;
  let blockAdvanceUntilCF377Ends = false;
  let blockAdvanceByInteractive = false;
  let blockAdvanceByClickblock = false;
  const CLUSTER_MATCH_ID_RADIUS = 36;
  const DUPLICATE_POS_RADIUS = 10000;
  const THOUGHT_APPEAR_DELAY = 5000;
  const thoughtPending = new Map();
  const thoughtCooldown = new Map();
  const THOUGHT_SPRING = 0.06;
  const THOUGHT_DAMPING = 0.82;
  const THOUGHT_MAX_VELOCITY = 12;


  let interactiveThoughtWasAlive = false;

function checkInteractiveThoughts() {
  const hasInteractive = activeThoughts.some(t => t.interactive && t.alive);
  blockAdvanceUntilInteractiveCleared = hasInteractive;

  if (hasInteractive) interactiveThoughtWasAlive = true;

  if (!hasInteractive && !yellowAnimationActive && !blockAdvanceUntilCF377Ends) {
    readyForClick = true;
  }

  const slide = slides[currentSlide];
  const slideHadInteractive = slide && slide.thoughts && slide.thoughts.some(t => t.interactive);

  if (!hasInteractive && slideHadInteractive && interactiveThoughtWasAlive) {
    interactiveThoughtWasAlive = false;
    blockAdvanceByInteractive = false;

    thoughtTemplates = [];
    activeThoughts = [];

    if (linkMap && linkMap.clear) linkMap.clear();
    breakingLinks = [];
    previousClusterRecords = [];
    nextClusterUid = 1;
    resetParticleHomes();

    showNextSlide();
  }
}


function updateThoughtsFromClusters(clusters) {
  const now = performance.now();

  for (const key of Array.from(thoughtPending.keys())) {
    const [tplIdxStr, clusterUid] = key.split('__');
    const tplIdx = Number(tplIdxStr);
    const cluster = clusters.find(c => c.uid === clusterUid);
    const tpl = (thoughtTemplates[tplIdx] !== undefined) ? ({ ...thoughtTemplates[tplIdx], __i: tplIdx }) : null;
    if (!cluster || !tpl || cluster.count < (tpl.minLinks || 5)) {
      thoughtPending.delete(key);
    }
  }

  for (const th of activeThoughts) {
    th._matchedCluster = clusters.find(c => c.uid === th.clusterUid) || null;
  }

  const clusterObjs = clusters.map(c => ({ ...c }));
  clusterObjs.sort((a, b) => b.count - a.count);

  const templates = thoughtTemplates
    .map((tpl, i) => ({ ...tpl, __i: i }))
    .sort((a, b) => (b.minLinks || 5) - (a.minLinks || 5));

  const usedClusterUids = new Set();
  activeThoughts.forEach(t => {
    if (t.clusterUid !== undefined && clusters.find(c => c.uid === t.clusterUid)) {
      usedClusterUids.add(t.clusterUid);
    }
  });

  for (const tpl of templates) {
    const need = tpl.minLinks || 5;

    const alreadyGlobal = activeThoughts.some(at => {
      const idx = (at.template && at.template.__i !== undefined) ? at.template.__i : thoughtTemplates.indexOf(at.template);
      const clusterAlive = (at.clusterUid !== undefined) && clusters.some(c => c.uid === at.clusterUid && c.count >= need);
      return idx === tpl.__i && clusterAlive;
    });
    if (alreadyGlobal) continue;

    let chosen = null;
    for (const c of clusterObjs) {
      if (usedClusterUids.has(c.uid)) continue;
      if (c.count < need) continue;
      const key = `${tpl.__i}__${c.uid}`;
      const cd = thoughtCooldown.get(key);
      if (cd && now < cd) continue;
      const dupNearby = activeThoughts.some(at => at.text === tpl.text && Math.hypot(at.x - c.x, at.y - c.y) < DUPLICATE_POS_RADIUS);
      if (dupNearby) continue;
      chosen = c;
      break;
    }

    if (chosen) {
      const key = `${tpl.__i}__${chosen.uid}`;
      const pending = thoughtPending.get(key);
      if (!pending) {
        thoughtPending.set(key, { since: now });
        usedClusterUids.add(chosen.uid);
      } else {
        if (now - pending.since >= THOUGHT_APPEAR_DELAY) {
          const exists = activeThoughts.find(at => at.text === tpl.text && at.clusterUid === chosen.uid);
          if (!exists) {
            const th = {
              id: nextThoughtId++,
              x: chosen.x,
              y: chosen.y,
              targetX: chosen.x,
              targetY: chosen.y - 30,
              text: tpl.text,
              alpha: 0,
              alive: true,
              template: tpl,
              clusterUid: chosen.uid,
              clusterCount: chosen.count,
              _flickerOffset: Math.random() * Math.PI * 2,
              interactive: !!tpl.interactive,
              vx: 0,
              vy: 0
            };
            activeThoughts.push(th);
          }
          thoughtPending.delete(key);
          usedClusterUids.add(chosen.uid);
        } else {
          usedClusterUids.add(chosen.uid);
        }
      }
    }
  }

  for (let i = activeThoughts.length - 1; i >= 0; i--) {
    const t = activeThoughts[i];
    const c = clusters.find(c => c.uid === t.clusterUid) || null;
    const removeBelow = t.template.removeBelow !== undefined ? t.template.removeBelow : Math.max(1, (t.template.minLinks || 5) - 2);

    if (!c || c.count < removeBelow) {
      if (t.alive) {
        const tplIdx = (t.template && t.template.__i !== undefined) ? t.template.__i : thoughtTemplates.indexOf(t.template);
        if (tplIdx >= 0 && t.clusterUid !== undefined) {
          const key = `${tplIdx}__${t.clusterUid}`;
          thoughtCooldown.set(key, now + THOUGHT_APPEAR_DELAY);
        }
      }
      t.alive = false;
    } else {
      t.clusterCount = c.count;
      t.targetX = c.x;
      t.targetY = c.y - 30;
      t.alpha += (1 - t.alpha) * 0.12;
      t.x += (t.targetX - t.x) * 0.14;
      t.y += (t.targetY - t.y) * 0.14;
    }

    if (!t.alive) {
      t.alpha *= 0.86;
      if (t.alpha < 0.02) {
        activeThoughts.splice(i, 1);
      }
    }
  }
  checkInteractiveThoughts();
}


  function drawThoughts() {
    const now = performance.now();
    for (const t of activeThoughts) {
      const flicker = 0.50 + 0.20 * Math.sin(now / 1000 + (t._flickerOffset || 0));
      const alpha = Math.max(0, Math.min(1, t.alpha * flicker));

      ctx.save();
      ctx.globalAlpha = alpha;
      ctx.font = "14px 'Courier New', monospace";
      ctx.textBaseline = 'top';

      const metrics = ctx.measureText(t.text);
      const textW = metrics.width;
      let x = t.x - textW / 2;
      let y = t.y - 22;

      if (x < 6) x = 6;
      if (x + textW > canvas.width - 6) x = canvas.width - textW - 6;
      if (y < 6) y = t.y + 10;

      if (t.interactive) {
        ctx.fillStyle = "#ffe066";
        let offsetX = x;
        for (let i = 0; i < t.text.length; i++) {
          const ch = t.text[i];
          const dx = (Math.random() - 0.5) * 1.2;
          const dy = (Math.random() - 0.5) * 1.2;
          ctx.save();
          ctx.shadowColor = "#ffe066";
          ctx.shadowBlur = 6;
          ctx.fillText(ch, offsetX + dx, y + dy);
          ctx.restore();
          offsetX += ctx.measureText(ch).width + 0.5;
        }
      } else {
        ctx.fillStyle = "rgba(255,255,255,1)";
        ctx.fillText(t.text, x, y);
      }
      ctx.restore();
    }
  }

  function roundRect(ctx, x, y, w, h, r, fill, stroke) {
    if (typeof r === 'undefined') r = 5;
    ctx.beginPath();
    ctx.moveTo(x + r, y);
    ctx.arcTo(x + w, y, x + w, y + h, r);
    ctx.arcTo(x + w, y + h, x, y + h, r);
    ctx.arcTo(x, y + h, x, y, r);
    ctx.arcTo(x, y, x + w, y, r);
    ctx.closePath();
    if (fill) ctx.fill();
    if (stroke) ctx.stroke();
  }

  function updateThoughtPositions() {
    for (const t of activeThoughts) {
      if (t.targetX === undefined || t.targetY === undefined) continue;

      const dx = t.targetX - t.x;
      const dy = t.targetY - t.y;

      t.vx += dx * THOUGHT_SPRING;
      t.vy += dy * THOUGHT_SPRING;

      const speed = Math.hypot(t.vx, t.vy);
      if (speed > THOUGHT_MAX_VELOCITY) {
        t.vx = (t.vx / speed) * THOUGHT_MAX_VELOCITY;
        t.vy = (t.vy / speed) * THOUGHT_MAX_VELOCITY;
      }

      t.vx *= THOUGHT_DAMPING;
      t.vy *= THOUGHT_DAMPING;

      t.x += t.vx;
      t.y += t.vy;

      if (Math.abs(dx) < 0.5 && Math.abs(dy) < 0.5) {
        t.vx *= 0.6;
        t.vy *= 0.6;
      }
    }
  }


  function animateParticles(time = 0) {
  frameCount++;
  activeRects = Array.from(document.querySelectorAll('.slide.active, .slide.out')).map(el => el.getBoundingClientRect());

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (frameCount % LINK_UPDATE_PERIOD === 0) {
    updateLinks(time);
  }
  
  drawLinks();

  for (let p of particles) {
    p.update(time);
    p.draw();
  }

  if (frameCount % CLUSTER_UPDATE_PERIOD === 0) {
    const clusters = computeClustersFromLinks();
    updateThoughtsFromClusters(clusters);
  }
  updateThoughtPositions();
  drawThoughts();

  if (typeof updateAndDrawThoughtFragments === 'function') updateAndDrawThoughtFragments(ctx);


const ALPHA_RECOVER_SPEED = 0.06;

particles.forEach(p => {
  if (p.eqAlphaTarget !== undefined) {
    if (p.eqAlpha === undefined) p.eqAlpha = 1;
    p.eqAlpha += (p.eqAlphaTarget - p.eqAlpha) * ALPHA_RECOVER_SPEED;
    if (Math.abs(p.eqAlpha - p.eqAlphaTarget) < 0.005) {
      p.eqAlpha = p.eqAlphaTarget;
      delete p.eqAlphaTarget;
    }
  }
});

links.forEach(l => {
  if (l.eqAlphaTarget !== undefined) {
    if (l.eqAlpha === undefined) l.eqAlpha = 1;
    l.eqAlpha += (l.eqAlphaTarget - l.eqAlpha) * ALPHA_RECOVER_SPEED;
    if (Math.abs(l.eqAlpha - l.eqAlphaTarget) < 0.005) {
      l.eqAlpha = l.eqAlphaTarget;
      delete l.eqAlphaTarget;
    }
  }
});

  requestAnimationFrame(animateParticles);

  if (isMarsEQ && analyser) {
  analyser.getByteFrequencyData(dataArray);

  let sum = 0, count = 0;
  for (let i = 8; i < 32; i++) {
    sum += dataArray[i];
    count++;
  }
  const avg = sum / count / 255;
  const target = Math.min(1, 0.15 + Math.pow(avg, 1.5));
  const decaySpeed = 0.02;

  particles.forEach(p => {
    if (p.eqAlpha === undefined) p.eqAlpha = 0;
    if (target > p.eqAlpha) {
      p.eqAlpha = target;
    } else {
      p.eqAlpha += (target - p.eqAlpha) * decaySpeed;
    }
  });

  links.forEach(l => {
    if (l.eqAlpha === undefined) l.eqAlpha = 0;
    const avgAlpha = (l.a.eqAlpha + l.b.eqAlpha) / 2;
    if (avgAlpha > l.eqAlpha) {
      l.eqAlpha = avgAlpha;
    } else {
      l.eqAlpha += (avgAlpha - l.eqAlpha) * decaySpeed;
    }
  });
}
}


  animateParticles();

  function resetParticleHomes() {
  particles.forEach(p => {
    p.homeX = Math.random() * canvas.width;
    p.homeY = Math.random() * canvas.height;
    p.nearTimes = {};
    if (!isFinite(p.x) || !isFinite(p.y)) { p.x = p.homeX; p.y = p.homeY; }
  });
}

  function applySlideThoughtTemplates(slide) {
    if (!slide || !slide.thoughts) {
      thoughtTemplates = [];
      activeThoughts = [];
      return;
    }

    thoughtTemplates = slide.thoughts.map(t => ({
      text: t.text || '',
      minLinks: t.minLinks || 5,
      removeBelow: (t.removeBelow !== undefined) ? t.removeBelow : Math.max(1, (t.minLinks || 5) - 2),
      interactive: !!t.interactive
    }));

    activeThoughts = [];
  }

  const cfAudio = audioMap.CF377;
  if (cfAudio) {
    cfAudio.addEventListener('playing', () => {
      blockAdvanceUntilCF377Ends = true;
      readyForClick = false;
    });
    cfAudio.addEventListener('ended', () => {
      blockAdvanceUntilCF377Ends = false;
      readyForClick = true;
    });
  }



  const SLIDE_ADVANCE_DEBOUNCE = 300;
  let __lastSlideAdvance = 0;

  if (typeof window.showNextSlide === 'function') {
    const _origShow = window.showNextSlide;
    window.showNextSlide = function(...args) {
      const now = performance.now();
      if (now - __lastSlideAdvance < SLIDE_ADVANCE_DEBOUNCE) {
        return;
      }
      __lastSlideAdvance = now;

      const res = _origShow.apply(this, args);

      const s = slides[currentSlide];
      try {
        applySlideThoughtTemplates(s);
      } catch (err) { console.warn("applySlideThoughtTemplates error:", err); }

      if (s?.play && s.play.includes('CF377')) {
        blockAdvanceUntilCF377Ends = true;
        readyForClick = false;
        try {
          const a = audioMap.CF377;
          if (a && !a.paused) {
          } else if (a && a.paused) {
          }
        } catch (e) {}
      } else {
        if (!yellowAnimationActive) readyForClick = true;
      }

      return res;
    };
  } else {
    window.showNextSlide = function() {
      const now = performance.now();
      if (now - __lastSlideAdvance < SLIDE_ADVANCE_DEBOUNCE) return;
      __lastSlideAdvance = now;
    };
  }

  const mo = new MutationObserver(mutations => {
    for (const m of mutations) {
      if (m.type === 'attributes' && m.attributeName === 'class') {
        const active = document.querySelector('.slide.active');
        if (active) {
          const idx = Array.from(slidesElements).indexOf(active);
          if (idx >= 0 && slides[idx]) {
            applySlideThoughtTemplates(slides[idx]);
            if (slides[idx].play && slides[idx].play.includes('CF377')) {
              blockAdvanceUntilCF377Ends = true;
              readyForClick = false;
            } else {
              if (!yellowAnimationActive) readyForClick = true;
            }
          }
        }
      }
    }
  });
  mo.observe(container, { attributes: true, subtree: true, attributeFilter: ['class'] });

</script>



</body>
</html>
